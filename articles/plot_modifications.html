<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modifying the network plot • NetCoMi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modifying the network plot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NetCoMi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/NetCoMi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/net_comparison.html">Network comparison</a></li>
    <li><a class="dropdown-item" href="../articles/diffnet.html">Differential networks</a></li>
    <li><a class="dropdown-item" href="../articles/dissimilarity_networks.html">Dissimilarity-based Networks</a></li>
    <li><a class="dropdown-item" href="../articles/create_asso_perm.html">Generate permuted association matrices</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>More examples</h6></li>
    <li><a class="dropdown-item" href="../articles/plot_modifications.html">Modifying the network plot</a></li>
    <li><a class="dropdown-item" href="../articles/asso_as_input.html">Association matrix as input</a></li>
    <li><a class="dropdown-item" href="../articles/cross_domain_networks.html">Cross-domain networks</a></li>
    <li><a class="dropdown-item" href="../articles/soil_example.html">Soil microbiome example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefpeschel/NetCoMi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modifying the network plot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stefpeschel/NetCoMi/blob/main/vignettes/plot_modifications.Rmd" class="external-link"><code>vignettes/plot_modifications.Rmd</code></a></small>
      <div class="d-none name"><code>plot_modifications.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://netcomi.de">NetCoMi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span></code></pre></div>
<p>We construct a network at genus level to demonstrate a variety of
modification options for the network plot. The SparCC package is used
here because the resulting graph is denser than conditional independence
graphs, which is preferable for this tutorial.</p>
<div class="section level2">
<h2 id="network-construction-and-analysis">Network construction and analysis<a class="anchor" aria-label="anchor" href="#network-construction-and-analysis"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"amgut2.filt.phy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agglomerate to genus level</span></span>
<span><span class="va">amgut_genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_glom.html" class="external-link">tax_glom</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, taxrank <span class="op">=</span> <span class="st">"Rank6"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename taxonomic table and make Rank6 (genus) unique</span></span>
<span><span class="va">amgut_genus_renamed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/renameTaxa.html">renameTaxa</a></span><span class="op">(</span><span class="va">amgut_genus</span>, </span>
<span>                                  pat <span class="op">=</span> <span class="st">"&lt;name&gt;"</span>, </span>
<span>                                  substPat <span class="op">=</span> <span class="st">"&lt;name&gt;_&lt;subst_name&gt;(&lt;subst_R&gt;)"</span>,</span>
<span>                                  numDupli <span class="op">=</span> <span class="st">"Rank6"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Column 7 contains NAs only and is ignored.</span></span>
<span></span>
<span><span class="co"># Network construction and analysis</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netConstruct.html">netConstruct</a></span><span class="op">(</span><span class="va">amgut_genus_renamed</span>,</span>
<span>                    taxRank <span class="op">=</span> <span class="st">"Rank6"</span>,</span>
<span>                    measure <span class="op">=</span> <span class="st">"sparcc"</span>,</span>
<span>                    normMethod <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>                    zeroMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    sparsMethod <span class="op">=</span> <span class="st">"thresh"</span>,</span>
<span>                    thresh <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                    dissFunc <span class="op">=</span> <span class="st">"signed"</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                    seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ...</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; 2 rows with zero sum removed.</span></span>
<span><span class="co">#&gt; 43 taxa and 294 samples remaining.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculate 'sparcc' associations ... Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sparsify associations via 'threshold' ... Done.</span></span>
<span></span>
<span><span class="va">netprops</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net</span>, </span>
<span>                       clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span>,</span>
<span>                       gcmHeat <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Do not plot the GCM heatmap</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="simple-network-plot">Simple network plot<a class="anchor" aria-label="anchor" href="#simple-network-plot"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_simple-1.png" width="100%"></p>
<p>In the following we will look at the different examples, where the
arguments of <code>plot.microNetProps</code> are adjusted.</p>
</div>
<div class="section level3">
<h3 id="layout">Layout<a class="anchor" aria-label="anchor" href="#layout"></a>
</h3>
<p>Circular layout:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, layout <span class="op">=</span> <span class="st">"circle"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_layout_circle-1.png" width="100%">
Layouts from <code>igraph</code>package are also accepted (see
<code><a href="https://r.igraph.org/reference/layout_.html" class="external-link">?igraph::layout_</a></code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, layout <span class="op">=</span> <span class="st">"layout_with_fr"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_layout_with_fr-1.png" width="100%"></p>
<p>We can also use a layout in matrix form. Here, we generate one in
advance using the Fruchterman-Reingold layout algorithm from
<code>igraph</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute layout</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">adjaMat1</span>, </span>
<span>                                             weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span><span class="va">lay_fr</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_with_fr.html" class="external-link">layout_with_fr</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Row names of the layout matrix must match the node names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">lay_fr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">adjaMat1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     layout <span class="op">=</span> <span class="va">lay_fr</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_layout_matrix-1.png" width="100%">
We can see that the layout is basically the same as before, just
rotated.</p>
</div>
<div class="section level3">
<h3 id="repulsion">Repulsion<a class="anchor" aria-label="anchor" href="#repulsion"></a>
</h3>
<p>Nodes are placed closer together for smaller repulsion values and
further apart for higher values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, repulsion <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_repulsion1-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, repulsion <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_repulsion2-1.png" width="100%"></p>
<p>For the rest of the tutorial we will use a repulsion of 0.9.</p>
</div>
<div class="section level3">
<h3 id="shorten-labels">Shorten labels<a class="anchor" aria-label="anchor" href="#shorten-labels"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     shortenLabels <span class="op">=</span> <span class="st">"simple"</span>, </span>
<span>     labelLength <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_shortlabs_simple-1.png" width="100%"></p>
<p>In many cases, it makes sense to use the ” intelligent ” label
shortening, which preserves the last part of the label. This allows you
to distinguish for instance between Enterococcus and Enterobacter. With
the following label pattern, they would be abbreviated to “Enter’coc”
and “Enter’bac”, while both would be abbreviated to “Entero” with the
“simple” shortening used before.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     shortenLabels <span class="op">=</span> <span class="st">"intelligent"</span>, </span>
<span>     labelPattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"'"</span>, <span class="fl">3</span>, <span class="st">"'"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_shortlabs_intelligent-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="label-size-and-scaling">Label size and scaling<a class="anchor" aria-label="anchor" href="#label-size-and-scaling"></a>
</h3>
<p>By default, labels are scaled according to node size.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     labelScale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_labelscale-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     labelScale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     cexLabels <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_labelscale_cex-1.png" width="100%"></p>
<p>If the labels overlap, one can play around with the
<code>repulsion</code> argument to randomly rearrange the node placement
until a good solution is found.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.901</span>,</span>
<span>     labelScale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     cexLabels <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_labelscale_rep-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="label-font">Label font<a class="anchor" aria-label="anchor" href="#label-font"></a>
</h3>
<p>Label fonts can be manipulated with the `labelFont’ argument. 2
stands for bold, 3 for italic, and so on. It is recommended to define
the hub label font separately.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">netprops</span>, </span>
<span>     repulsion <span class="op">=</span> <span class="fl">0.901</span>,</span>
<span>     labelScale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     cexLabels <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>     labelFont <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     hubLabelFont  <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_modifications_files/figure-html/netplot_mod_label_font-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://stefpeschel.de/" class="external-link">Stefanie Peschel</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
