<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generate permuted association matrices • NetCoMi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate permuted association matrices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NetCoMi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/NetCoMi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/net_comparison.html">Network comparison</a></li>
    <li><a class="dropdown-item" href="../articles/diffnet.html">Differential networks</a></li>
    <li><a class="dropdown-item" href="../articles/dissimilarity_networks.html">Dissimilarity-based Networks</a></li>
    <li><a class="dropdown-item" href="../articles/create_asso_perm.html">Generate permuted association matrices</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>More examples</h6></li>
    <li><a class="dropdown-item" href="../articles/plot_modifications.html">Modifying the network plot</a></li>
    <li><a class="dropdown-item" href="../articles/asso_as_input.html">Association matrix as input</a></li>
    <li><a class="dropdown-item" href="../articles/cross_domain_networks.html">Cross-domain networks</a></li>
    <li><a class="dropdown-item" href="../articles/soil_example.html">Soil microbiome example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefpeschel/NetCoMi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate permuted association matrices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stefpeschel/NetCoMi/blob/main/vignettes/create_asso_perm.Rmd" class="external-link"><code>vignettes/create_asso_perm.Rmd</code></a></small>
      <div class="d-none name"><code>create_asso_perm.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://netcomi.de">NetCoMi</a></span><span class="op">)</span></span></code></pre></div>
<p>This tutorial demonstrates how to use the <code>createAssoPerm</code>
function for storing and reloading count tables, association matrices
and network properties of the permuted data if <strong>permutation
tests</strong> are performed with <code><a href="../reference/netCompare.html">netCompare()</a></code> or
<code><a href="../reference/diffnet.html">diffnet()</a></code>.</p>
<p>NetCoMi (&gt;=1.0.2) includes the function
<code><a href="../reference/createAssoPerm.html">createAssoPerm()</a></code> for creating either only a matrix with
permuted group labels or storing count tables and association matrices
of the permuted data. The stored files can be passed to
<code><a href="../reference/netCompare.html">netCompare()</a></code> and <code><a href="../reference/diffnet.html">diffnet()</a></code> so that users can
repeatedly run these two functions with varying arguments, without the
need to recompute the associations each time.
<code><a href="../reference/createAssoPerm.html">createAssoPerm()</a></code> additionally enables to compute the
permutation associations block-wise (for a subset of permutations) and
store them in separate files. These files can then be combined to one
large matrix (with all permutations) and passed to
<code><a href="../reference/netCompare.html">netCompare()</a></code> or <code><a href="../reference/diffnet.html">diffnet()</a></code>.</p>
<p>The tutorial furthermore explains NetCoMi’s ability to handle
<strong>matched data sets</strong>.</p>
<div class="section level3">
<h3 id="network-construction-and-analysis">Network construction and analysis<a class="anchor" aria-label="anchor" href="#network-construction-and-analysis"></a>
</h3>
<p>We use data from the American Gut Project and conduct a network
comparison between subjects with and without lactose intolerance.</p>
<p>To demonstrate NetCoMi’s functionality for <strong>matched
data</strong>, we build a “fake” 1:2 matched data set, where each two
samples of the <code>LACTOSE = "no"</code> group are assigned to one
sample of the <code>LACTOSE = "yes"</code> group. We use a subset of 150
samples, leading to 50 samples in group “yes” and 100 samples in group
“no”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://netcomi.de">NetCoMi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load American Gut Data (from SpiecEasi package)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"amgut2.filt.phy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#table(amgut2.filt.phy@sam_data@.Data[[which(amgut2.filt.phy@sam_data@names == "LACTOSE")]])</span></span>
<span></span>
<span><span class="co"># Divide samples into two groups: with and without lactose intolerance</span></span>
<span><span class="va">lact_yes</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, <span class="va">LACTOSE</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="va">lact_no</span>  <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, <span class="va">LACTOSE</span> <span class="op">==</span> <span class="st">"no"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract count tables</span></span>
<span><span class="va">counts_yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">as</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html" class="external-link">otu_table</a></span><span class="op">(</span><span class="va">lact_yes</span><span class="op">)</span>, <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counts_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">as</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html" class="external-link">otu_table</a></span><span class="op">(</span><span class="va">lact_no</span><span class="op">)</span>, <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build the 1:2 matched data set</span></span>
<span><span class="va">counts_matched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">150</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">counts_yes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_matched</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_yes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts_matched</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">150</span></span>
<span><span class="va">ind_yes</span> <span class="op">&lt;-</span> <span class="va">ind_no</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">3</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">counts_matched</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">counts_yes</span><span class="op">[</span><span class="va">ind_yes</span>, <span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts_matched</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts_yes</span><span class="op">)</span><span class="op">[</span><span class="va">ind_yes</span><span class="op">]</span></span>
<span>    <span class="va">ind_yes</span> <span class="op">&lt;-</span> <span class="va">ind_yes</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">counts_matched</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">counts_no</span><span class="op">[</span><span class="va">ind_no</span>, <span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts_matched</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts_no</span><span class="op">)</span><span class="op">[</span><span class="va">ind_no</span><span class="op">]</span></span>
<span>    <span class="va">ind_no</span> <span class="op">&lt;-</span> <span class="va">ind_no</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># The corresponding group vector used for splitting the data into two subsets.</span></span>
<span><span class="va">group_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># Note: group "1" belongs to "yes", group "2" belongs to "no"</span></span>
<span></span>
<span><span class="co"># Network construction</span></span>
<span><span class="va">net_amgut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netConstruct.html">netConstruct</a></span><span class="op">(</span><span class="va">counts_matched</span>, </span>
<span>                          group <span class="op">=</span> <span class="va">group_vec</span>,</span>
<span>                          matchDesign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          filtTax <span class="op">=</span> <span class="st">"highestFreq"</span>,</span>
<span>                          filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestFreq <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                          measure <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>                          zeroMethod <span class="op">=</span> <span class="st">"pseudo"</span>, </span>
<span>                          normMethod <span class="op">=</span> <span class="st">"clr"</span>,</span>
<span>                          sparsMethod <span class="op">=</span> <span class="st">"threshold"</span>, </span>
<span>                          thresh <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Data filtering ...</span></span>
<span><span class="co">#&gt; 88 taxa removed.</span></span>
<span><span class="co">#&gt; 50 taxa and 150 samples remaining.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Zero treatment:</span></span>
<span><span class="co">#&gt; Pseudo count of 1 added.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Normalization:</span></span>
<span><span class="co">#&gt; Execute clr(){SpiecEasi} ... Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculate 'pearson' associations ... Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculate associations in group 2 ... Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sparsify associations via 'threshold' ... Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sparsify associations in group 2 ... Done.</span></span>
<span></span>
<span><span class="co"># Network analysis with default values</span></span>
<span><span class="va">props_amgut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net_amgut</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_asso_perm_files/figure-html/network_construction-1.png" width="12000"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#summary(props_amgut)</span></span>
<span></span>
<span><span class="co"># Network plot</span></span>
<span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props_amgut</span>, sameLayout <span class="op">=</span> <span class="cn">TRUE</span>, layoutGroup <span class="op">=</span> <span class="st">"union"</span>, </span>
<span>     nodeSize <span class="op">=</span> <span class="st">"clr"</span>, repulsion <span class="op">=</span> <span class="fl">0.9</span>, cexTitle <span class="op">=</span> <span class="fl">3.7</span>, cexNodes <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     cexLabels <span class="op">=</span> <span class="fl">2</span>, groupNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LACTOSE = yes"</span>, <span class="st">"LACTOSE = no"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottom"</span>, title <span class="op">=</span> <span class="st">"estimated correlation:"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"-"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#009900"</span>,<span class="st">"red"</span><span class="op">)</span>, inset <span class="op">=</span> <span class="fl">0.02</span>, cex <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">4</span>, </span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_asso_perm_files/figure-html/network_construction-2.png" width="12000"></p>
</div>
<div class="section level3">
<h3 id="network-comparison-via-the-classical-way">Network comparison via the “classical way”<a class="anchor" aria-label="anchor" href="#network-comparison-via-the-classical-way"></a>
</h3>
<p>We conduct a network comparison with permutation tests to examine
whether group differences are significant. In order to reduce the
execution time, only 100 permutations are used. For real data sets, the
number of permutations should be at least 1000 to get reliable
results.</p>
<p>The matrices with estimated associations for the permuted data are
stored in an external file (in the current working directory) named
<code>"assoPerm_comp"</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Network comparison</span></span>
<span><span class="va">comp_amgut_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netCompare.html">netCompare</a></span><span class="op">(</span><span class="va">props_amgut</span>, permTest <span class="op">=</span> <span class="cn">TRUE</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          storeAssoPerm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          fileStoreAssoPerm <span class="op">=</span> <span class="st">"assoPerm_comp"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                          seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Calculate network properties ... Done.</span></span>
<span><span class="co">#&gt; Files 'assoPerm_comp.bmat and assoPerm_comp.desc.txt created. </span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Calculating p-values ... Done.</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'adaptBH' ... Done.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">comp_amgut_orig</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparison of Network Properties</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt; CALL: </span></span>
<span><span class="co">#&gt; netCompare(x = props_amgut, permTest = TRUE, nPerm = 100, seed = 123456, </span></span>
<span><span class="co">#&gt;     storeAssoPerm = TRUE, fileStoreAssoPerm = "assoPerm_comp", </span></span>
<span><span class="co">#&gt;     storeCountsPerm = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ______________________________</span></span>
<span><span class="co">#&gt; Global network properties</span></span>
<span><span class="co">#&gt; `````````````````````````</span></span>
<span><span class="co">#&gt; Largest connected component (LCC):</span></span>
<span><span class="co">#&gt;                          group '1'   group '2'    abs.diff.     p-value  </span></span>
<span><span class="co">#&gt; Relative LCC size            0.480       0.400        0.080    0.950495  </span></span>
<span><span class="co">#&gt; Clustering coefficient       0.510       0.635        0.125    0.584158  </span></span>
<span><span class="co">#&gt; Modularity                   0.261       0.175        0.085    0.524752  </span></span>
<span><span class="co">#&gt; Positive edge percentage    57.627      62.500        4.873    0.554455  </span></span>
<span><span class="co">#&gt; Edge density                 0.214       0.295        0.081    0.693069  </span></span>
<span><span class="co">#&gt; Natural connectivity         0.080       0.109        0.029    0.742574  </span></span>
<span><span class="co">#&gt; Vertex connectivity          1.000       1.000        0.000    1.000000  </span></span>
<span><span class="co">#&gt; Edge connectivity            1.000       1.000        0.000    1.000000  </span></span>
<span><span class="co">#&gt; Average dissimilarity*       0.921       0.887        0.033    0.693069  </span></span>
<span><span class="co">#&gt; Average path length**        1.786       1.459        0.327    0.643564  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Whole network:</span></span>
<span><span class="co">#&gt;                          group '1'   group '2'    abs.diff.     p-value  </span></span>
<span><span class="co">#&gt; Number of components        21.000      27.000        6.000    0.861386  </span></span>
<span><span class="co">#&gt; Clustering coefficient       0.463       0.635        0.172    0.247525  </span></span>
<span><span class="co">#&gt; Modularity                   0.332       0.252        0.080    0.504950  </span></span>
<span><span class="co">#&gt; Positive edge percentage    58.462      63.333        4.872    0.564356  </span></span>
<span><span class="co">#&gt; Edge density                 0.053       0.049        0.004    0.871287  </span></span>
<span><span class="co">#&gt; Natural connectivity         0.030       0.031        0.001    0.772277  </span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt; p-values: one-tailed test with null hypothesis diff=0</span></span>
<span><span class="co">#&gt;  *: Dissimilarity = 1 - edge weight</span></span>
<span><span class="co">#&gt; **: Path length = Units with average dissimilarity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ______________________________</span></span>
<span><span class="co">#&gt; Jaccard index (similarity betw. sets of most central nodes)</span></span>
<span><span class="co">#&gt; ```````````````````````````````````````````````````````````</span></span>
<span><span class="co">#&gt;                     Jacc   P(&lt;=Jacc)     P(&gt;=Jacc)    </span></span>
<span><span class="co">#&gt; degree             0.615    0.991177      0.034655 *  </span></span>
<span><span class="co">#&gt; betweenness centr. 0.312    0.546936      0.660877    </span></span>
<span><span class="co">#&gt; closeness centr.   0.529    0.972716      0.075475 .  </span></span>
<span><span class="co">#&gt; eigenvec. centr.   0.625    0.995960      0.015945 *  </span></span>
<span><span class="co">#&gt; hub taxa           0.500    0.888889      0.407407    </span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt; Jaccard index in [0,1] (1 indicates perfect agreement)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ______________________________</span></span>
<span><span class="co">#&gt; Adjusted Rand index (similarity betw. clusterings)</span></span>
<span><span class="co">#&gt; ``````````````````````````````````````````````````</span></span>
<span><span class="co">#&gt;         wholeNet       LCC</span></span>
<span><span class="co">#&gt; ARI        0.383     0.281</span></span>
<span><span class="co">#&gt; p-value    0.000     0.000</span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt; ARI in [-1,1] with ARI=1: perfect agreement betw. clusterings</span></span>
<span><span class="co">#&gt;                    ARI=0: expected for two random clusterings</span></span>
<span><span class="co">#&gt; p-value: permutation test (n=1000) with null hypothesis ARI=0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ______________________________</span></span>
<span><span class="co">#&gt; Graphlet Correlation Distance</span></span>
<span><span class="co">#&gt; `````````````````````````````</span></span>
<span><span class="co">#&gt;         wholeNet         LCC  </span></span>
<span><span class="co">#&gt; GCD     0.914000    2.241000  </span></span>
<span><span class="co">#&gt; p-value 0.633663    0.574257  </span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt; GCD &gt;= 0 (GCD=0 indicates perfect agreement between GCMs)</span></span>
<span><span class="co">#&gt; p-value: permutation test with null hypothesis GCD=0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ______________________________</span></span>
<span><span class="co">#&gt; Centrality measures</span></span>
<span><span class="co">#&gt; - In decreasing order</span></span>
<span><span class="co">#&gt; - Centrality of disconnected components is zero</span></span>
<span><span class="co">#&gt; ````````````````````````````````````````````````</span></span>
<span><span class="co">#&gt; Degree (normalized):</span></span>
<span><span class="co">#&gt;        group '1' group '2' abs.diff. adj.p-value  </span></span>
<span><span class="co">#&gt; 364563     0.061     0.245     0.184           1  </span></span>
<span><span class="co">#&gt; 190597     0.102     0.000     0.102           1  </span></span>
<span><span class="co">#&gt; 369164     0.102     0.000     0.102           1  </span></span>
<span><span class="co">#&gt; 184983     0.184     0.102     0.082           1  </span></span>
<span><span class="co">#&gt; 194648     0.000     0.082     0.082           1  </span></span>
<span><span class="co">#&gt; 353985     0.082     0.000     0.082           1  </span></span>
<span><span class="co">#&gt; 242070     0.082     0.000     0.082           1  </span></span>
<span><span class="co">#&gt; 307981     0.122     0.184     0.061           1  </span></span>
<span><span class="co">#&gt; 188236     0.122     0.184     0.061           1  </span></span>
<span><span class="co">#&gt; 363302     0.102     0.041     0.061           1  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Betweenness centrality (normalized):</span></span>
<span><span class="co">#&gt;        group '1' group '2' abs.diff. adj.p-value  </span></span>
<span><span class="co">#&gt; 353985     0.320     0.000     0.320    0.494890  </span></span>
<span><span class="co">#&gt; 364563     0.040     0.216     0.177    0.999678  </span></span>
<span><span class="co">#&gt; 188236     0.024     0.187     0.163    0.999678  </span></span>
<span><span class="co">#&gt; 307981     0.020     0.158     0.138    0.999678  </span></span>
<span><span class="co">#&gt; 157547     0.103     0.000     0.103    0.999678  </span></span>
<span><span class="co">#&gt; 71543      0.091     0.000     0.091    0.999678  </span></span>
<span><span class="co">#&gt; 590083     0.087     0.000     0.087    0.742335  </span></span>
<span><span class="co">#&gt; 190597     0.079     0.000     0.079    0.999678  </span></span>
<span><span class="co">#&gt; 194648     0.000     0.070     0.070    0.999678  </span></span>
<span><span class="co">#&gt; 288134     0.063     0.129     0.065    0.999678  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Closeness centrality (normalized):</span></span>
<span><span class="co">#&gt;        group '1' group '2' abs.diff. adj.p-value  </span></span>
<span><span class="co">#&gt; 190597     0.871     0.000     0.871    0.489307  </span></span>
<span><span class="co">#&gt; 194648     0.000     0.868     0.868    0.768911  </span></span>
<span><span class="co">#&gt; 242070     0.809     0.000     0.809    0.733961  </span></span>
<span><span class="co">#&gt; 369164     0.788     0.000     0.788    0.733961  </span></span>
<span><span class="co">#&gt; 302160     0.000     0.677     0.677    0.988400  </span></span>
<span><span class="co">#&gt; 353985     0.639     0.000     0.639    0.733961  </span></span>
<span><span class="co">#&gt; 516022     0.000     0.561     0.561    0.988400  </span></span>
<span><span class="co">#&gt; 181095     0.515     0.000     0.515    0.733961  </span></span>
<span><span class="co">#&gt; 590083     0.507     0.000     0.507    0.489307  </span></span>
<span><span class="co">#&gt; 470239     0.349     0.000     0.349    0.988400  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvector centrality (normalized):</span></span>
<span><span class="co">#&gt;        group '1' group '2' abs.diff. adj.p-value  </span></span>
<span><span class="co">#&gt; 242070     0.469     0.000     0.469      0.9998  </span></span>
<span><span class="co">#&gt; 307981     0.334     0.672     0.339      0.9998  </span></span>
<span><span class="co">#&gt; 301645     0.332     0.661     0.329      0.9998  </span></span>
<span><span class="co">#&gt; 364563     0.079     0.339     0.260      0.9998  </span></span>
<span><span class="co">#&gt; 369164     0.201     0.000     0.201      0.9998  </span></span>
<span><span class="co">#&gt; 326792     0.130     0.300     0.170      0.9998  </span></span>
<span><span class="co">#&gt; 157547     0.632     0.801     0.169      0.9998  </span></span>
<span><span class="co">#&gt; 190597     0.146     0.000     0.146      0.9998  </span></span>
<span><span class="co">#&gt; 363302     0.153     0.012     0.141      0.9998  </span></span>
<span><span class="co">#&gt; 71543      0.910     0.777     0.133      0.9998  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; _________________________________________________________</span></span>
<span><span class="co">#&gt; Significance codes: ***: 0.001, **: 0.01, *: 0.05, .: 0.1</span></span></code></pre>
<p>The network comparison is repeated, but this time, the stored
permutation associations are loaded by <code><a href="../reference/netCompare.html">netCompare()</a></code>. This
option might be useful to rerun the function with alternative multiple
testing adjustment, without the need of re-estimating all
associations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Network comparison</span></span>
<span><span class="va">comp_amgut1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netCompare.html">netCompare</a></span><span class="op">(</span><span class="va">props_amgut</span>, permTest <span class="op">=</span> <span class="cn">TRUE</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          fileLoadAssoPerm <span class="op">=</span> <span class="st">"assoPerm_comp"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                          seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Calculate network properties ... Done.</span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Calculating p-values ... Done.</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'adaptBH' ... Done.</span></span>
<span></span>
<span><span class="co"># Check whether the second comparison leads to equal results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">comp_amgut_orig</span><span class="op">$</span><span class="va">properties</span>, <span class="va">comp_amgut1</span><span class="op">$</span><span class="va">properties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The stored permutation associations can also be passed to
<code><a href="../reference/diffnet.html">diffnet()</a></code> to construct a differential network.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct differential network</span></span>
<span><span class="va">diffnet_amgut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffnet.html">diffnet</a></span><span class="op">(</span><span class="va">net_amgut</span>, diffMethod <span class="op">=</span> <span class="st">"permute"</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          fileLoadAssoPerm <span class="op">=</span> <span class="st">"assoPerm_comp"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ...</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'lfdr' ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Execute fdrtool() ...</span></span>
<span><span class="co">#&gt; Step 1... determine cutoff point</span></span>
<span><span class="co">#&gt; Step 2... estimate parameters of null distribution and eta0</span></span>
<span><span class="co">#&gt; Step 3... compute p-values and estimate empirical PDF/CDF</span></span>
<span><span class="co">#&gt; Step 4... compute q-values and local fdr</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; No significant differential associations detected after multiple testing adjustment.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">diffnet_amgut</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in plot.diffnet(diffnet_amgut): There are no differential correlations to plot (after multiple testing adjustment).</span></span></code></pre></div>
<p>As expected for a number of permutations of only 100, there are no
differential associations after multiple testing adjustment.</p>
<p>Just to take a look how the differential network could look like, we
plot the differential network based on non-adjusted p-values. Note that
this approach is statistically not correct!</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">diffnet_amgut</span>, adjusted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, legendPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">1.2</span><span class="op">)</span>,</span>
<span>     legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,</span>
<span>     legendGroupnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span>,</span>
<span>     legendTitle <span class="op">=</span> <span class="st">"Correlations:"</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_asso_perm_files/figure-html/diffnet_2-1.png" width="3000"></p>
</div>
<div class="section level3">
<h3 id="network-comparison-using-createassoperm">Network comparison using createAssoPerm()<a class="anchor" aria-label="anchor" href="#network-comparison-using-createassoperm"></a>
</h3>
<p>This time, the permutation association matrices are generated using
<code><a href="../reference/createAssoPerm.html">createAssoPerm()</a></code> and then passed to
<code><a href="../reference/netCompare.html">netCompare()</a></code>.</p>
<p>The output should be written to a variable because
<code><a href="../reference/createAssoPerm.html">createAssoPerm()</a></code> generally returns the matrix with permuted
group labels.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">permGroupMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                               computeAsso <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               fileStoreAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                               storeCountsPerm <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                               append <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a look at the permuted group labels. To interpret the
group labels correctly, it is important to know, that within
<code><a href="../reference/netConstruct.html">netConstruct()</a></code>, the data set is divided into two matrices
belonging to the two groups. For the permutation tests, the two matrices
are combined by rows and for each permutation, the samples are
reassigned to one of the two groups while keeping the matching design
for matched data.</p>
<p>In our case, the <code>permGroupMat</code> matrix consists of 100
rows (<code>nPerm = 100</code>) and 150 columns (our sample size). The
first 50 columns belong to the first group (group “yes” in our case) and
columns 51 to 150 belong to the second group.</p>
<p>Since each two samples of group 2 are matched to one sample of group
1, we number the group label matrix accordingly. Now, we can see that
the matching design is kept: Since sample 3 is assigned to group 1,
samples 1 and 2 have to be assigned to group 2 and so on (entries [1,1]
and [1,51:52] of <code>permGroupMat</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">150</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">seq2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">seq1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">permGroupMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">seq1</span>, <span class="va">seq2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">permGroupMat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;      1 4 7 10 13 16 19 22 25 28</span></span>
<span><span class="co">#&gt; [1,] 2 2 2  2  1  2  2  1  2  2</span></span>
<span><span class="co">#&gt; [2,] 2 2 2  1  1  2  2  2  2  2</span></span>
<span><span class="co">#&gt; [3,] 2 2 1  1  2  2  2  1  2  2</span></span>
<span><span class="co">#&gt; [4,] 2 2 1  2  1  2  2  2  1  1</span></span>
<span><span class="co">#&gt; [5,] 2 2 2  2  2  1  2  2  2  2</span></span>
<span><span class="va">permGroupMat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">51</span><span class="op">:</span><span class="fl">71</span><span class="op">]</span></span>
<span><span class="co">#&gt;      2 3 5 6 8 9 11 12 14 15 17 18 20 21 23 24 26 27 29 30 32</span></span>
<span><span class="co">#&gt; [1,] 2 1 1 2 2 1  1  2  2  2  1  2  2  1  2  2  2  1  1  2  1</span></span>
<span><span class="co">#&gt; [2,] 2 1 2 1 2 1  2  2  2  2  1  2  1  2  2  1  2  1  2  1  2</span></span>
<span><span class="co">#&gt; [3,] 2 1 1 2 2 2  2  2  1  2  1  2  2  1  2  2  1  2  2  1  2</span></span>
<span><span class="co">#&gt; [4,] 1 2 1 2 2 2  1  2  2  2  1  2  2  1  1  2  2  2  2  2  1</span></span>
<span><span class="co">#&gt; [5,] 2 1 2 1 1 2  2  1  1  2  2  2  2  1  1  2  1  2  1  2  2</span></span></code></pre></div>
<p>As before, the stored permutation association matrices are passed to
<code><a href="../reference/netCompare.html">netCompare()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_amgut2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netCompare.html">netCompare</a></span><span class="op">(</span><span class="va">props_amgut</span>, permTest <span class="op">=</span> <span class="cn">TRUE</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          fileLoadAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Calculate network properties ... Done.</span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Calculating p-values ... Done.</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'adaptBH' ... Done.</span></span>
<span></span>
<span><span class="co"># Are the network properties equal?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">comp_amgut_orig</span><span class="op">$</span><span class="va">properties</span>, <span class="va">comp_amgut2</span><span class="op">$</span><span class="va">properties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Using the <code>fm.open</code> function, we take a look at the stored
matrices themselves.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open stored files and check whether they are equal</span></span>
<span><span class="va">assoPerm1</span> <span class="op">&lt;-</span> <span class="fu">filematrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/filematrix/man/fm.create.html" class="external-link">fm.open</a></span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm_comp"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">assoPerm2</span> <span class="op">&lt;-</span> <span class="fu">filematrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/filematrix/man/fm.create.html" class="external-link">fm.open</a></span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span></span>
<span><span class="co"># Close files </span></span>
<span><span class="fu">filematrix</span><span class="fu">::</span><span class="fu">close</span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span></span>
<span><span class="fu">filematrix</span><span class="fu">::</span><span class="fu">close</span><span class="op">(</span><span class="va">assoPerm2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-wise-execution">Block-wise execution<a class="anchor" aria-label="anchor" href="#block-wise-execution"></a>
</h3>
<p>Due to limited resources, it might be meaningful to estimate the
associations in blocks, that is, for a subset of permutations instead of
all permutations at once. We’ll now see how to perform such a block-wise
network comparison using NetCoMi’s functions. Note that in this
approach, the external file is extended in each iteration, which is why
it is not parallelizable.</p>
<p>In the first step, <code>createAssoPerm</code> is used to generate
the matrix with permuted group labels (for all permutations!). Hence, we
set the <code>computeAsso</code> parameter to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">permGroupMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                               computeAsso <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Create matrix with permuted group labels ... Done.</span></span></code></pre></div>
<p>We now compute the association matrices in blocks of 20 permutations
in each loop (leading to 5 iterations).</p>
<p>Note: The <code>nPerm</code> argument must be set to the block
size.</p>
<p>The external file (containing the association matrices) must be
extended in each loop, except for the first iteration, where the file is
created. Thus, <code>append</code> is set to <code>TRUE</code> for
<code>i &gt;=2</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPerm_all</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">blocksize</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="va">nPerm_all</span> <span class="op">/</span> <span class="va">blocksize</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Create a new file in the first run</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="va">blocksize</span>, </span>
<span>                          permGroupMat <span class="op">=</span> <span class="va">permGroupMat</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">blocksize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">blocksize</span>, <span class="op">]</span>,</span>
<span>                          computeAsso <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          fileStoreAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="va">blocksize</span>, </span>
<span>                          permGroupMat <span class="op">=</span> <span class="va">permGroupMat</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">blocksize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">blocksize</span>, <span class="op">]</span>,</span>
<span>                          computeAsso <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          fileStoreAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; Files 'assoPerm.bmat and assoPerm.desc.txt created.</span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span></code></pre></div>
<p>The stored file, which now contains the associations of all 100
permutations, can be passed to <code><a href="../reference/netCompare.html">netCompare()</a></code> as before.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_amgut3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netCompare.html">netCompare</a></span><span class="op">(</span><span class="va">props_amgut</span>, permTest <span class="op">=</span> <span class="cn">TRUE</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          storeAssoPerm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          fileLoadAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Calculate network properties ... Done.</span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Calculating p-values ... Done.</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'adaptBH' ... Done.</span></span>
<span></span>
<span><span class="co"># Are the network properties equal to the first comparison?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">comp_amgut_orig</span><span class="op">$</span><span class="va">properties</span>, <span class="va">comp_amgut3</span><span class="op">$</span><span class="va">properties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Open stored files and check whether they are equal</span></span>
<span><span class="va">assoPerm1</span> <span class="op">&lt;-</span> <span class="fu">fm.open</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm_comp"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">assoPerm3</span> <span class="op">&lt;-</span> <span class="fu">fm.open</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span></span>
<span><span class="co"># Close files </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">assoPerm3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-wise-execution-executable-in-parallel">Block-wise execution (executable in parallel)<a class="anchor" aria-label="anchor" href="#block-wise-execution-executable-in-parallel"></a>
</h3>
<p>If the blocks should be computed in parallel, extending the
<code>"assoPerm"</code> file in each iteration would not work. To be
able to run the blocks in parallel, we have to create a separate file in
each iteration and combine them at the end.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the matrix with permuted group labels (as before)</span></span>
<span><span class="va">permGroupMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, computeAsso <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                               seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Create matrix with permuted group labels ... Done.</span></span>
<span></span>
<span></span>
<span><span class="va">nPerm_all</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">blocksize</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="va">nPerm_all</span> <span class="op">/</span> <span class="va">blocksize</span>  <span class="co"># 5 repetitions</span></span>
<span></span>
<span><span class="co"># Execute as standard for-loop:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="va">blocksize</span>, </span>
<span>                        permGroupMat <span class="op">=</span> <span class="va">permGroupMat</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">blocksize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">blocksize</span>, <span class="op">]</span>,</span>
<span>                        computeAsso <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        fileStoreAssoPerm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"assoPerm"</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>                        storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Files 'assoPerm1.bmat and assoPerm1.desc.txt created. </span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Files 'assoPerm2.bmat and assoPerm2.desc.txt created. </span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Files 'assoPerm3.bmat and assoPerm3.desc.txt created. </span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Files 'assoPerm4.bmat and assoPerm4.desc.txt created. </span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Files 'assoPerm5.bmat and assoPerm5.desc.txt created. </span></span>
<span><span class="co">#&gt; Compute permutation associations ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span></span>
<span><span class="co"># OR execute in parallel:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">"foreach"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cores</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Please choose an appropriate number of cores</span></span>
<span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">cores</span><span class="op">)</span></span>
<span><span class="fu">doSNOW</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doSNOW/man/registerDoSNOW.html" class="external-link">registerDoSNOW</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create progress bar:</span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">txtProgressBar</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">repetitions</span>, style<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%</span></span>
<span></span>
<span><span class="va">progress</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">setTxtProgressBar</a></span><span class="op">(</span><span class="va">pb</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>      </span>
<span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>progress <span class="op">=</span> <span class="va">progress</span><span class="op">)</span></span>
<span>      </span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span>,</span>
<span>               .packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NetCoMi"</span><span class="op">)</span>,</span>
<span>               .options.snow <span class="op">=</span> <span class="va">opts</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> <span class="op">{</span></span>
<span>                 </span>
<span>                 <span class="fu">progress</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>                 <span class="fu">NetCoMi</span><span class="fu">::</span><span class="fu"><a href="../reference/createAssoPerm.html">createAssoPerm</a></span><span class="op">(</span><span class="va">props_amgut</span>, nPerm <span class="op">=</span> <span class="va">blocksize</span>, </span>
<span>                          permGroupMat <span class="op">=</span> <span class="va">permGroupMat</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">blocksize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">blocksize</span>, <span class="op">]</span>,</span>
<span>                          computeAsso <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          fileStoreAssoPerm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"assoPerm"</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%</span></span>
<span></span>
<span><span class="co"># Close progress bar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">pb</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Stop cluster</span></span>
<span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Combine the matrices and store them into a new file (because netCompare() </span></span>
<span><span class="co"># needs an external file)</span></span>
<span><span class="va">assoPerm_all</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">assoPerm_tmp</span> <span class="op">&lt;-</span> <span class="fu">fm.open</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"assoPerm"</span>, <span class="va">i</span><span class="op">)</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">assoPerm_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">assoPerm_all</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm_tmp</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">assoPerm_tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">assoPerm_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span></span>
<span><span class="co"># Combine the permutation association matrices</span></span>
<span><span class="fu">fm.create.from.matrix</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm"</span>, mat <span class="op">=</span> <span class="va">assoPerm_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5000 x 100 filematrix with 8 byte "double" elements</span></span></code></pre></div>
<p>As last step, we pass the file containing the combined matrix to
<code><a href="../reference/netCompare.html">netCompare()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_amgut4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netCompare.html">netCompare</a></span><span class="op">(</span><span class="va">props_amgut</span>, permTest <span class="op">=</span> <span class="cn">TRUE</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          fileLoadAssoPerm <span class="op">=</span> <span class="st">"assoPerm"</span>,</span>
<span>                          storeCountsPerm <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input arguments ... Done.</span></span>
<span><span class="co">#&gt; Calculate network properties ... Done.</span></span>
<span><span class="co">#&gt; Execute permutation tests ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; Calculating p-values ... Done.</span></span>
<span><span class="co">#&gt; Adjust for multiple testing using 'adaptBH' ... Done.</span></span>
<span></span>
<span><span class="co"># Are the network properties equal to those of the first comparison?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">comp_amgut_orig</span><span class="op">$</span><span class="va">properties</span>, <span class="va">comp_amgut4</span><span class="op">$</span><span class="va">properties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Open stored files and check whether they are equal</span></span>
<span><span class="va">assoPerm1</span> <span class="op">&lt;-</span> <span class="fu">fm.open</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm_comp"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">assoPerm4</span> <span class="op">&lt;-</span> <span class="fu">fm.open</span><span class="op">(</span>filenamebase <span class="op">=</span> <span class="st">"assoPerm"</span> , readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">assoPerm4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000  100</span></span>
<span></span>
<span><span class="co"># Close files </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">assoPerm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">assoPerm4</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://stefpeschel.de/" class="external-link">Stefanie Peschel</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
