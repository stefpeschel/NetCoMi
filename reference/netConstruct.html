<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Constructing Networks for Microbiome Data — netConstruct • NetCoMi</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constructing Networks for Microbiome Data — netConstruct"><meta name="description" content="Constructing microbial association networks and dissimilarity
  based networks (where nodes are subjects) from compositional count data."><meta property="og:description" content="Constructing microbial association networks and dissimilarity
  based networks (where nodes are subjects) from compositional count data."><meta property="og:image" content="https://netcomi.de/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NetCoMi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/NetCoMi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/net_comparison.html">Network comparison</a></li>
    <li><a class="dropdown-item" href="../articles/diffnet.html">Differential networks</a></li>
    <li><a class="dropdown-item" href="../articles/dissimilarity_networks.html">Dissimilarity-based Networks</a></li>
    <li><a class="dropdown-item" href="../articles/create_asso_perm.html">Generate permuted association matrices</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>More examples</h6></li>
    <li><a class="dropdown-item" href="../articles/asso_as_input.html">Association matrix as input</a></li>
    <li><a class="dropdown-item" href="../articles/cross_domain_networks.html">Cross-domain networks</a></li>
    <li><a class="dropdown-item" href="../articles/soil_example.html">Soil microbiome example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefpeschel/NetCoMi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Constructing Networks for Microbiome Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/stefpeschel/NetCoMi/blob/main/R/netConstruct.R" class="external-link"><code>R/netConstruct.R</code></a></small>
      <div class="d-none name"><code>netConstruct.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructing microbial association networks and dissimilarity
  based networks (where nodes are subjects) from compositional count data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">netConstruct</span><span class="op">(</span><span class="va">data</span>,</span>
<span>             data2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             dataType <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>             group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             matchDesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             taxRank <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             </span>
<span>             <span class="co"># Association/dissimilarity measure:</span></span>
<span>             measure <span class="op">=</span> <span class="st">"spieceasi"</span>,</span>
<span>             measurePar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             </span>
<span>             <span class="co"># Preprocessing:</span></span>
<span>             jointPrepro <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             filtTax <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>             filtTaxPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             filtSamp <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>             filtSampPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             zeroMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>             zeroPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             normMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>             normPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             </span>
<span>             <span class="co"># Sparsification:</span></span>
<span>             sparsMethod <span class="op">=</span> <span class="st">"t-test"</span>,</span>
<span>             thresh <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>             adjust <span class="op">=</span> <span class="st">"adaptBH"</span>,</span>
<span>             trueNullMethod <span class="op">=</span> <span class="st">"convest"</span>,</span>
<span>             lfdrThresh <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>             nboot <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>             assoBoot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>             logFile <span class="op">=</span> <span class="st">"log.txt"</span>,</span>
<span>             softThreshType <span class="op">=</span> <span class="st">"signed"</span>,</span>
<span>             softThreshPower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             softThreshCut <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>             kNeighbor <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>             knnMutual <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             </span>
<span>             <span class="co"># Transformation:</span></span>
<span>             dissFunc <span class="op">=</span> <span class="st">"signed"</span>,</span>
<span>             dissFuncPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             simFunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             simFuncPar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             scaleDiss <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             weighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             </span>
<span>             <span class="co"># Further arguments:</span></span>
<span>             sampleSize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             verbose <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span>             <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>numeric matrix. Can be a count matrix (rows are samples, columns
are OTUs/taxa), a phyloseq object, or an association/dissimilarity matrix
(<code>dataType</code> must be set).
a second count matrix/phyloseq object or a second association/dissimilarity
matrix.</p></dd>


<dt id="arg-data-">data2<a class="anchor" aria-label="anchor" href="#arg-data-"></a></dt>
<dd><p>optional numeric matrix used for constructing a second
network (belonging to group 2). Can be either a second count
matrix/phyloseq object or a second association/dissimilarity matrix.</p></dd>


<dt id="arg-datatype">dataType<a class="anchor" aria-label="anchor" href="#arg-datatype"></a></dt>
<dd><p>character indicating the data type. Defaults to "counts",
which means that <code>data</code> (and data2) is a count matrix or object of
class <code><a href="https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html" class="external-link">phyloseq</a></code>. Further options
are "correlation", "partialCorr" (partial correlation), "condDependence"
(conditional dependence), "proportionality" and "dissimilarity".</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>optional binary vector used for splitting the data into two
groups. If <code>group</code> is <code>NULL</code> (default) and <code>data2</code> is not
set, a single network is constructed. See 'Details.'</p></dd>


<dt id="arg-matchdesign">matchDesign<a class="anchor" aria-label="anchor" href="#arg-matchdesign"></a></dt>
<dd><p>Numeric vector with two elements specifying an optional
matched-group (i.e. matched-pair) design, which is used for the permutation
tests in <code><a href="netCompare.html">netCompare</a></code> and <code><a href="diffnet.html">diffnet</a></code>. <code>c(1,1)</code>
corresponds to a matched-pair design. A 1:2 matching, for instance, is
defined by <code>c(1,2)</code>, which means that the first sample of group 1 is
matched to the first two samples of group 2 and so on.
The appropriate order of samples must be ensured. If
<code>NULL</code>, the group memberships are shuffled randomly while group sizes
identical to the original data set are ensured.</p></dd>


<dt id="arg-taxrank">taxRank<a class="anchor" aria-label="anchor" href="#arg-taxrank"></a></dt>
<dd><p>character indicating the taxonomic rank at which the network
should be constructed. Only used if data (and data 2) is a phyloseq object.
The given rank must match one of the column names of the taxonomic table
(the <code>@tax_table</code> slot of the phyloseq object). Taxa names of the
chosen taxonomic rank must be unique (consider using the function
<code><a href="renameTaxa.html">renameTaxa</a></code> to make them unique). If a phyloseq object is
given and <code>taxRank = NULL</code>, the row names of the OTU table are used
as node labels.</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>character specifying the method used for either computing the
associations between taxa or dissimilarities between subjects.
Ignored if <code>data</code> is not a count matrix (if <code>dataType</code> is not set
to <code>"counts"</code>). Available measures are:
<code>"pearson"</code>, <code>"spearman"</code>, <code>"bicor"</code>, <code>"sparcc"</code>,
<code>"cclasso"</code>, <code>"ccrepe"</code>, <code>"spieceasi"</code> (default),
<code>"spring"</code>, <code>"gcoda"</code> and <code>"propr"</code> as association measures,
and <code>"euclidean"</code>, <code>"bray"</code>, <code>"kld"</code>, <code>"jeffrey"</code>,
<code>"jsd"</code>, <code>"ckld"</code>, and <code>"aitchison"</code> as dissimilarity
measures. Parameters are set via <code>measurePar</code>.</p></dd>


<dt id="arg-measurepar">measurePar<a class="anchor" aria-label="anchor" href="#arg-measurepar"></a></dt>
<dd><p>list with parameters passed to the function for computing
associations/dissimilarities. See 'Details' for the respective functions.
For SpiecEasi or SPRING as association measure, an additional list element
"symBetaMode" is accepted to define the "mode" argument of
<code><a href="https://rdrr.io/pkg/SpiecEasi/man/symBeta.html" class="external-link">symBeta</a></code>.</p></dd>


<dt id="arg-jointprepro">jointPrepro<a class="anchor" aria-label="anchor" href="#arg-jointprepro"></a></dt>
<dd><p>logical indicating whether data preprocessing (filtering,
zero treatment, normalization) should be done for the combined data sets,
or each data set separately. Ignored if a single network is constructed.
Defaults to <code>TRUE</code> if <code>group</code> is given, and to <code>FALSE</code> if
<code>data2</code> is given. Joint preprocessing is not possible for
dissimilarity networks.</p></dd>


<dt id="arg-filttax">filtTax<a class="anchor" aria-label="anchor" href="#arg-filttax"></a></dt>
<dd><p>character indicating how taxa shall be filtered. Possible
options are:</p><dl><dt><code>"none"</code></dt>
<dd><p>Default. All taxa are kept.</p></dd>

<dt><code>"totalReads"</code></dt>
<dd><p>Keep taxa with a total number
of reads of at least x.</p></dd>

<dt><code>"relFreq"</code></dt>
<dd><p>Keep taxa whose number of reads is at
least x% of the total number of reads.</p></dd>

<dt><code>"numbSamp"</code></dt>
<dd><p>Keep taxa observed in at least x samples.</p></dd>

<dt><code>"highestVar"</code></dt>
<dd><p>Keep the x taxa with highest variance.</p></dd>

<dt><code>"highestFreq"</code></dt>
<dd><p>Keep the x taxa with highest frequency.</p></dd>


</dl><p>Except for "highestVar" and "highestFreq", different filter methods can be
combined. The values x are set via <code>filtTaxPar</code>.</p></dd>


<dt id="arg-filttaxpar">filtTaxPar<a class="anchor" aria-label="anchor" href="#arg-filttaxpar"></a></dt>
<dd><p>list with parameters for the filter methods given by
<code>filtTax</code>. Possible list entries are: <code>"totalReads"</code> (int),
<code>"relFreq"</code> (value in [0,1]), <code>"numbSamp"</code> (int),
<code>"highestVar"</code> (int), <code>"highestFreq"</code> (int).</p></dd>


<dt id="arg-filtsamp">filtSamp<a class="anchor" aria-label="anchor" href="#arg-filtsamp"></a></dt>
<dd><p>character indicating how samples shall be filtered. Possible
options are:</p><dl><dt><code>"none"</code></dt>
<dd><p>Default. All samples are kept.</p></dd>

<dt><code>"totalReads"</code></dt>
<dd><p>Keep samples with a total number of reads of at
least x.</p></dd>

<dt><code>"numbTaxa"</code></dt>
<dd><p>Keep samples for which at least
x taxa are observed.</p></dd>

<dt><code>"highestFreq"</code></dt>
<dd><p>Keep the x samples with highest frequency.</p></dd>

</dl><p>Except for "highestFreq", different filter methods can be
combined. The values x are set via <code>filtSampPar</code>.</p></dd>


<dt id="arg-filtsamppar">filtSampPar<a class="anchor" aria-label="anchor" href="#arg-filtsamppar"></a></dt>
<dd><p>list with parameters for the filter methods given by
<code>filtSamp</code>. Possible list entries are: <code>"totalReads"</code> (int),
<code>"numbTaxa"</code> (int), <code>"highestFreq"</code> (int).</p></dd>


<dt id="arg-zeromethod">zeroMethod<a class="anchor" aria-label="anchor" href="#arg-zeromethod"></a></dt>
<dd><p>character indicating the method used for zero replacement.
Possible values are: <code>"none"</code> (default), <code>"pseudo"</code>,
<code>"pseudoZO"</code>, <code>"multRepl"</code>, <code>"alrEM"</code>, <code>"bayesMult"</code>.
See 'Details'. The corresponding parameters are set via <code>zeroPar</code>.
<code>zeroMethod</code> is ignored if the approach for
calculating the associations/dissimilarity includes zero handling.
Defaults to <code>"multRepl"</code> or <code>"pseudo"</code> (depending on the expected
input of the normalization function and measure) if zero replacement is
required.</p></dd>


<dt id="arg-zeropar">zeroPar<a class="anchor" aria-label="anchor" href="#arg-zeropar"></a></dt>
<dd><p>list with parameters passed to the function for zero
replacement (<code>zeroMethod</code>). See the help page of the respective
function for details. If <code>zeroMethod</code> is <code>"pseudo"</code> or
<code>"pseudoZO"</code>, the pseudo count can be specified via
<code>zeroPar = list(pseudocount = x)</code> (where x is numeric).</p></dd>


<dt id="arg-normmethod">normMethod<a class="anchor" aria-label="anchor" href="#arg-normmethod"></a></dt>
<dd><p>character indicating the normalization method (to
make counts of different samples comparable). Possible options are:
<code>"none"</code> (default), <code>"TSS"</code> (or <code>"fractions"</code>), <code>"CSS"</code>,
<code>"COM"</code>, <code>"rarefy"</code>, <code>"VST"</code>, <code>"clr"</code>, and
<code>"mclr"</code>. See 'Details'. The corresponding parameters are set via
<code>normPar</code>.</p></dd>


<dt id="arg-normpar">normPar<a class="anchor" aria-label="anchor" href="#arg-normpar"></a></dt>
<dd><p>list with parameters passed to the function for normalization
(defined by <code>normMethod</code>).</p></dd>


<dt id="arg-sparsmethod">sparsMethod<a class="anchor" aria-label="anchor" href="#arg-sparsmethod"></a></dt>
<dd><p>character indicating the method used for sparsification
(selected edges that are connected in the network). Available methods are:</p><dl><dt><code>"none"</code></dt>
<dd><p>Leads to a fully connected network</p></dd>

<dt><code>"t-test"</code></dt>
<dd><p>Default. Associations being significantly different
from zero are selected using Student's t-test. Significance level and
multiple testing adjustment is specified via <code>alpha</code> and
<code>adjust</code>. <code>sampleSize</code> must be set if <code>dataType</code> is not
"counts".</p></dd>

<dt><code>"bootstrap"</code></dt>
<dd><p>Bootstrap procedure as described in
<cite>Friedman and Alm (2012)</cite>. Corresponding arguments are
<code>nboot</code>, <code>cores</code>, and <code>logFile</code>. Data type must be
"counts".</p></dd>

<dt><code>"threshold"</code></dt>
<dd><p>Selected are taxa
pairs with an absolute association/dissimilarity greater than or equal to
the threshold defined via <code>thresh</code>.</p></dd>

<dt><code>"softThreshold"</code></dt>
<dd><p>Soft thresholding method according to
<cite>Zhang and Horvath (2005)</cite> available in the
<code><a href="https://rdrr.io/pkg/WGCNA/man/pickSoftThreshold.html" class="external-link">WGCNA</a></code> package. Corresponding
arguments are <code>softThreshType</code>, <code>softThreshPower</code>, and
<code>softThreshCut</code>.</p></dd>

<dt><code>"knn"</code></dt>
<dd><p>Construct a k-nearest neighbor or mutual k-nearest
neighbor graph using <code><a href="https://rdrr.io/pkg/cccd/man/nng.html" class="external-link">nng</a></code>. Corresponding
arguments are <code>kNeighbor</code>, and <code>knnMutual</code>. Available for
dissimilarity networks only.</p></dd>

</dl></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>numeric vector with one or two elements defining the threshold
used for sparsification if <code>sparsMethod</code> is set to <code>"threshold"</code>.
If two networks are constructed and one value is given, it is used
for both groups. Defaults to 0.3.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric vector with one or two elements indicating the
significance level. Only used if Student's t-test or bootstrap
procedure is used as sparsification method. If two networks are constructed
and one value is given, it is used for both groups. Defaults to 0.05.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>character indicating the method used for multiple testing
adjustment (if Student's t-test or bootstrap procedure is used for edge
selection). Possible values are <code>"lfdr"</code> (default) for local
false discovery rate correction (via <code><a href="https://rdrr.io/pkg/fdrtool/man/fdrtool.html" class="external-link">fdrtool</a></code>),
<code>"adaptBH"</code> for the adaptive Benjamini-Hochberg method
<cite>(Benjamini and Hochberg, 2000)</cite>, or one of the methods provided by
<code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code> (see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust.methods()</a></code>.</p></dd>


<dt id="arg-truenullmethod">trueNullMethod<a class="anchor" aria-label="anchor" href="#arg-truenullmethod"></a></dt>
<dd><p>character indicating the method used for estimating the
proportion of true null hypotheses from a vector of p-values. Used for the
adaptive Benjamini-Hochberg method for multiple testing adjustment (chosen
by <code>adjust = "adaptBH"</code>). Accepts the provided options of the
<code>method</code> argument of <code><a href="https://rdrr.io/pkg/limma/man/propTrueNull.html" class="external-link">propTrueNull</a></code>:
<code>"convest"</code>(default), <code>"lfdr"</code>, <code>"mean"</code>, and <code>"hist"</code>.
Can alternatively be <code>"farco"</code> for
the "iterative plug-in method" proposed by <cite>Farcomeni (2007)</cite>.</p></dd>


<dt id="arg-lfdrthresh">lfdrThresh<a class="anchor" aria-label="anchor" href="#arg-lfdrthresh"></a></dt>
<dd><p>numeric vector with one or two elements defining the
threshold(s) for local FDR correction (if <code>adjust = "locfdr"</code>).
Defaults to 0.2 meaning that associations with a
corresponding local FDR less than or equal to 0.2 are identified as
significant. If two networks are constructed and one value is given, it is
used for both groups.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>integer indicating the number of bootstrap samples, if
bootstrapping is used as sparsification method.</p></dd>


<dt id="arg-assoboot">assoBoot<a class="anchor" aria-label="anchor" href="#arg-assoboot"></a></dt>
<dd><p>logical or list. Only relevant for bootstrapping.
Set to <code>TRUE</code> if a list (<code>assoBoot</code>) with bootstrap association
matrices should be returned. Can also be a list with bootstrap
association matrices, which are used for sparsification. See the example.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>integer indicating the number of CPU cores used for
bootstrapping. If cores &gt; 1, bootstrapping is performed parallel.
<code>cores</code> is limited to the number of available CPU cores determined by
<code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></code>. Then, core arguments of the function
used for association estimation (if provided) should be set to 1.</p></dd>


<dt id="arg-logfile">logFile<a class="anchor" aria-label="anchor" href="#arg-logfile"></a></dt>
<dd><p>character defining a log file to which the iteration numbers
are stored if bootstrapping is used for sparsification. The file is written
to the current working directory. Defaults to <code>"log.txt"</code>.
If<code> NULL</code>, no log file is created.</p></dd>


<dt id="arg-softthreshtype">softThreshType<a class="anchor" aria-label="anchor" href="#arg-softthreshtype"></a></dt>
<dd><p>character indicating the method used for transforming
correlations into similarities if soft thresholding is used as sparsification
method (<code>sparsMethod = "softThreshold"</code>). Possible values are
<code>"signed"</code>, <code>"unsigned"</code>, and <code>"signed hybrid"</code> (according
to the available options for the argument <code>type</code> of
<code><a href="https://rdrr.io/pkg/WGCNA/man/adjacency.html" class="external-link">adjacency</a></code> from <code>WGCNA</code> package).</p></dd>


<dt id="arg-softthreshpower">softThreshPower<a class="anchor" aria-label="anchor" href="#arg-softthreshpower"></a></dt>
<dd><p>numeric vector with one or two elements defining the
power for soft thresholding. Only used if
<code>edgeSelect = "softThreshold"</code>. If two networks are constructed and
one value is given, it is used for both groups. If no power is set, it is
computed using <code><a href="https://rdrr.io/pkg/WGCNA/man/pickSoftThreshold.html" class="external-link">pickSoftThreshold</a></code>, where the argument
<code>softThreshCut</code> is needed in addition.</p></dd>


<dt id="arg-softthreshcut">softThreshCut<a class="anchor" aria-label="anchor" href="#arg-softthreshcut"></a></dt>
<dd><p>numeric vector with one or two elements (each between 0
and 1) indicating the desired minimum scale free topology fitting index
(corresponds to the argument "RsquaredCut" in
<code><a href="https://rdrr.io/pkg/WGCNA/man/pickSoftThreshold.html" class="external-link">pickSoftThreshold</a></code>). Defaults to 0.8.
If two networks are constructed and one value is given, it is
used for both groups.</p></dd>


<dt id="arg-kneighbor">kNeighbor<a class="anchor" aria-label="anchor" href="#arg-kneighbor"></a></dt>
<dd><p>integer specifying the number of neighbors if the k-nearest
neighbor method is used for sparsification. Defaults to 3L.</p></dd>


<dt id="arg-knnmutual">knnMutual<a class="anchor" aria-label="anchor" href="#arg-knnmutual"></a></dt>
<dd><p>logical used for k-nearest neighbor sparsification. If
<code>TRUE</code>, the neighbors must be mutual. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-dissfunc">dissFunc<a class="anchor" aria-label="anchor" href="#arg-dissfunc"></a></dt>
<dd><p>method used for transforming associations into
dissimilarities. Can be a character with one of the following values:
<code>"signed"</code>(default), <code>"unsigned"</code>, <code>"signedPos"</code>,
<code>"TOMdiss"</code>.
Alternatively, a function is accepted with the association matrix as first
argument and optional further arguments, which can be set via
<code>dissFuncPar</code>. Ignored for dissimilarity measures. See 'Details.'</p></dd>


<dt id="arg-dissfuncpar">dissFuncPar<a class="anchor" aria-label="anchor" href="#arg-dissfuncpar"></a></dt>
<dd><p>optional list with parameters if a function is passed to
<code>dissFunc</code>.</p></dd>


<dt id="arg-simfunc">simFunc<a class="anchor" aria-label="anchor" href="#arg-simfunc"></a></dt>
<dd><p>function for transforming dissimilarities into
similarities. Defaults to f(x)=1-x for dissimilarities in [0,1], and
f(x)=1/(1 + x) otherwise.</p></dd>


<dt id="arg-simfuncpar">simFuncPar<a class="anchor" aria-label="anchor" href="#arg-simfuncpar"></a></dt>
<dd><p>optional list with parameters for the function passed to
<code>simFunc</code>.</p></dd>


<dt id="arg-scalediss">scaleDiss<a class="anchor" aria-label="anchor" href="#arg-scalediss"></a></dt>
<dd><p>logical. Indicates whether dissimilarity values should be
scaled to [0,1] by (x - min(dissEst)) / (max(dissEst) - min(dissEst)),
where dissEst is the matrix with estimated dissimilarities.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-weighted">weighted<a class="anchor" aria-label="anchor" href="#arg-weighted"></a></dt>
<dd><p>logical. If <code>TRUE</code>, similarity values are used as
adjacencies. <code>FALSE</code> leads to a binary adjacency matrix whose entries
equal 1 for (sparsified) similarity values &gt; 0, and 0 otherwise.</p></dd>


<dt id="arg-samplesize">sampleSize<a class="anchor" aria-label="anchor" href="#arg-samplesize"></a></dt>
<dd><p>numeric vector with one or two elements giving the number
of samples that have been used for computing the association matrix.
Only needed if an association matrix
is given instead of a count matrix and if, in addition, Student's t-test is
used for edge selection. If two networks are constructed and one value is
given, it is used for both groups.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>integer indicating the level of verbosity. Possible values:
<code>"0"</code>: no messages, <code>"1"</code>: only important messages,
<code>"2"</code>(default): all progress messages, <code>"3"</code> messages returned
by external functions are shown in addition. Can also be logical.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer giving a seed for reproducibility of the results.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>microNet</code> containing the following elements:</p><table class="table table"><tr><td><code>edgelist1, edgelist2</code></td><td>Edge list with the following columns:
  <ul><li><p><code>v1</code>, <code>v2</code>: names of adjacent nodes/vertices</p></li>
<li><p><code>asso</code>: estimated association (only for association networks)</p></li>
<li><p><code>diss</code>: dissimilarity</p></li>
<li><p><code>sim</code>: similarity (only for unweighted networks)</p></li>
<li><p><code>adja</code>: adjacency (equals similarity for
  weighted networks)</p></li>
</ul></td></tr><tr><td><code>assoMat1, assoMat2</code></td><td>Sparsified associations (<code>NULL</code> for
  dissimilarity based networks)</td></tr><tr><td><code>dissMat1, dissMat2</code></td><td>Sparsified dissimilarities (for association
  networks, these are the sparsified associations transformed into
  dissimilarities)</td></tr><tr><td><code>simMat1, simMat2</code></td><td>Sparsified similarities</td></tr><tr><td><code>adjaMat1, adjaMat2</code></td><td>Adjacency matrices</td></tr><tr><td><code>assoEst1, assoEst2</code></td><td>Estimated associations (<code>NULL</code> for
  dissimilarity based networks)</td></tr><tr><td><code>dissEst1, dissEst2</code></td><td>Estimated dissimilarities (<code>NULL</code> for
  association networks)</td></tr><tr><td><code>dissScale1, dissScale2</code></td><td>Scaled dissimilarities (<code>NULL</code> for
  association networks)</td></tr><tr><td><code>assoBoot1, assoBoot2</code></td><td>List with association matrices for the
  bootstrap samples. Returned if bootstrapping is used for
  sparsification and <code>assoBoot</code> is <code>TRUE</code>.</td></tr><tr><td><code>countMat1, countMat2</code></td><td>Count matrices after filtering but before
  zero replacement and normalization. Only returned if <code>jointPrepro</code>
  is <code>FALSE</code> or for a single network.</td></tr><tr><td><code>countsJoint</code></td><td>Joint count matrix after filtering but before
  zero replacement and normalization. Only returned if <code>jointPrepro</code>
  is <code>TRUE</code>.</td></tr><tr><td><code>normCounts1, normCounts2</code></td><td>Count matrices after zero handling and
  normalization</td></tr><tr><td><code>groups</code></td><td>Names of the factor levels according to which the groups
  have been built</td></tr><tr><td><code>softThreshPower</code></td><td>Determined (or given) power for
  soft-thresholding.</td></tr><tr><td><code>assoType</code></td><td>Data type (either given by <code>dataType</code> or
  determined from <code>measure</code>)</td></tr><tr><td><code>twoNets</code></td><td>Indicates whether two networks have been constructed</td></tr><tr><td><code>parameters</code></td><td>Parameters used for network construction</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The object returned by <code>netConstruct</code> can either be passed to
  <code><a href="netAnalyze.html">netAnalyze</a></code> for network analysis, or to
  <code><a href="diffnet.html">diffnet</a></code> to construct a differential network from the
  estimated associations.
  <br>
  The function enables the construction of either a <strong>single network</strong>
  or <strong>two networks</strong>. The latter can be compared using the function
  <code><a href="netCompare.html">netCompare</a></code>.
  <br><br>
  The network(s) can either be based on <strong>associations</strong> (correlation,
  partial correlation / conditional dependence, proportionality) or
  <strong>dissimilarities</strong>. Several measures are available, respectively,
  to estimate associations or dissimilarities using <code>netConstruct</code>.
  Alternatively, a pre-generated association or dissimilarity matrix is
  accepted as input to start the workflow (argument <code>dataType</code> must be
  set appropriately).
  Depending on the measure, network nodes are either taxa or subjects:
  In association-based networks nodes are taxa, whereas in
  dissimilarity-based networks nodes are subjects.
  <br><br>
  In order to perform a <strong>network comparison</strong>, the following options
  for constructing two networks are available:</p><ol><li><p>Passing the combined count matrix to <code>data</code> and a group
    vector to <code>group</code> (of length <code>nrow(data)</code> for association
    networks and of length <code>ncol(data)</code> for dissimilarity-based
    networks).</p></li>
<li><p>Passing the count data for group 1 to <code>data</code> (matrix or
    phyloseq object) and the count data for group 2 to <code>data2</code> (matrix
    or phyloseq object). For association networks, the column names must
    match, and for dissimilarity networks the row names.</p></li>
<li><p>Passing an association/dissimilarity matrix for group 1 to
    <code>data</code> and an association/dissimilarity matrix for group 2 to
    <code>data2</code>.</p></li>
</ol><p><br><strong>Group labeling:</strong><br>
  If two networks are generated, the network belonging to <code>data</code>
  is always denoted by "group 1" and the network belonging to <code>data2</code>
  by "group 2".<br>
  If a group vector is used for splitting the data into two groups, the group
  names are assigned according to the order of group levels. If <code>group</code>
  contains the levels 0 and 1, for instance, "group 1" is assigned to level 0
  and "group 2" is assigned to level 1. <br>
  In the network plot, group 1 is shown on the left and group 2 on the
  right if not defined otherwise (see <code><a href="plot.microNetProps.html">plot.microNetProps</a></code>).
  <br><br><strong>Association measures</strong></p><table class="table table"><tr><td>Argument</td><td>Function</td></tr><tr><td><code>"pearson"</code></td><td><code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code></td></tr><tr><td><code>"spearman"</code></td><td><code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code></td></tr><tr><td><code>"bicor"</code></td><td><code><a href="https://rdrr.io/pkg/WGCNA/man/bicor.html" class="external-link">bicor</a></code></td></tr><tr><td><code>"sparcc"</code></td><td><code><a href="https://rdrr.io/pkg/SpiecEasi/man/sparcc.html" class="external-link">sparcc</a></code></td></tr><tr><td><code>"cclasso"</code></td><td><code><a href="cclasso.html">cclasso</a></code></td></tr><tr><td><code>"ccrepe"</code></td><td><code><a href="https://rdrr.io/pkg/ccrepe/man/ccrepe.html" class="external-link">ccrepe</a></code></td></tr><tr><td><code>"spieceasi"</code></td><td><code><a href="https://rdrr.io/pkg/SpiecEasi/man/spiec.easi.html" class="external-link">spiec.easi</a></code></td></tr><tr><td><code>"spring"</code></td><td><code><a href="https://rdrr.io/pkg/SPRING/man/SPRING.html" class="external-link">SPRING</a></code></td></tr><tr><td><code>"gcoda"</code></td><td><code><a href="gcoda.html">gcoda</a></code></td></tr><tr><td><code>"propr"</code></td><td><code><a href="https://rdrr.io/pkg/propr/man/propr.html" class="external-link">propr</a></code></td></tr></table><p><br><strong>Dissimilarity measures</strong></p><table class="table table"><tr><td>Argument</td><td>Function</td><td>Measure</td></tr><tr><td><code>"euclidean"</code></td><td><code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></code></td><td>Euclidean distance</td></tr><tr><td><code>"bray"</code></td><td><code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></code></td><td>Bray-Curtis  dissimilarity</td></tr><tr><td><code>"kld"</code></td><td><code><a href="https://rdrr.io/pkg/LaplacesDemon/man/KLD.html" class="external-link">KLD</a></code></td><td>Kullback-Leibler divergence</td></tr><tr><td><code>"jeffrey"</code></td><td><code><a href="https://rdrr.io/pkg/LaplacesDemon/man/KLD.html" class="external-link">KLD</a></code></td><td>Jeffrey divergence</td></tr><tr><td><code>"jsd"</code></td><td><code><a href="https://rdrr.io/pkg/LaplacesDemon/man/KLD.html" class="external-link">KLD</a></code></td><td>Jensen-Shannon divergence</td></tr><tr><td><code>"ckld"</code></td><td><code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></code></td><td>Compositional Kullback-Leibler divergence</td></tr><tr><td><code>"aitchison"</code></td><td><code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></code>,
  <code>cenLR</code></td><td>Aitchison distance</td></tr></table><p>Definitions:<br></p><dl><dt>Kullback-Leibler divergence:</dt>
<dd><p>Since KLD is not symmetric,
  0.5 * (KLD(p(x)||p(y)) + KLD(p(y)||p(x))) is returned.</p></dd>

  <dt>Jeffrey divergence:</dt>
<dd><p>Jeff = KLD(p(x)||p(y)) + KLD(p(y)||p(x))</p></dd>

  <dt>Jensen-Shannon divergence:</dt>
<dd><p>JSD = 0.5 KLD(P||M) + 0.5 KLD(Q||M),
  where P=p(x), Q=p(y), and M=0.5(P+Q).</p></dd>

  <dt>Compositional Kullback-Leibler divergence:</dt>
<dd><p>cKLD(x,y) =
  p/2 * log(A(x/y) * A(y/x)), where A(x/y) is the arithmetic mean of the
  vector of ratios x/y.</p></dd>

  <dt>Aitchison distance:</dt>
<dd><p>Euclidean distance of the clr-transformed data.</p></dd>


</dl><p><br><strong>Methods for zero replacement</strong></p><table class="table table"><tr><td>Argument</td><td>Method</td><td>Function</td></tr><tr><td><code>"none"</code></td><td>No zero replacement (only available if no zero
  replacement is needed for the chosen normalization method and
  association/dissimilarity measure).</td><td>-</td></tr><tr><td><code>"pseudo"</code></td><td>A pseudo count (defined by <code>pseudocount</code> as
  optional element of <code>zeroPar</code>) is added to all counts. A unit zero
  count is used by default.</td><td>-</td></tr><tr><td><code>"pseudoZO"</code></td><td>A pseudo count (defined by <code>pseudocount</code> as
  optional element of <code>zeroPar</code>) is added to zero counts only.
  A unit zero count is used by default.</td><td>-</td></tr><tr><td><code>"multRepl"</code></td><td>Multiplicative simple replacement</td><td><code><a href="https://rdrr.io/pkg/zCompositions/man/multRepl.html" class="external-link">multRepl</a></code></td></tr><tr><td><code>"alrEM"</code></td><td>Modified EM alr-algorithm</td><td><code><a href="https://rdrr.io/pkg/zCompositions/man/lrEM.html" class="external-link">lrEM</a></code></td></tr><tr><td><code>"bayesMult"</code></td><td>Bayesian-multiplicative replacement</td><td><code><a href="https://rdrr.io/pkg/zCompositions/man/cmultRepl.html" class="external-link">cmultRepl</a></code></td></tr></table><p><strong>Normalization methods</strong></p><table class="table table"><tr><td>Argument</td><td>Method</td><td>Function</td></tr><tr><td><code>"TSS"</code></td><td>Total sum scaling</td><td>t(apply(countMat, 1, function(x)
  x/sum(x)))</td></tr><tr><td><code>"CSS"</code></td><td>Cumulative sum scaling</td><td><code><a href="https://rdrr.io/pkg/metagenomeSeq/man/cumNormMat.html" class="external-link">cumNormMat</a></code></td></tr><tr><td><code>"COM"</code></td><td>Common sum scaling</td><td>t(apply(countMat, 1, function(x) x * min(rowSums(countMat)) / sum(x)))</td></tr><tr><td><code>"rarefy"</code></td><td>Rarefying</td><td><code><a href="https://rdrr.io/pkg/vegan/man/rarefy.html" class="external-link">rrarefy</a></code></td></tr><tr><td><code>"VST"</code></td><td>Variance stabilizing transformation</td><td><code><a href="https://rdrr.io/pkg/DESeq2/man/varianceStabilizingTransformation.html" class="external-link">varianceStabilizingTransformation</a></code></td></tr><tr><td><code>"clr"</code></td><td>Centered log-ratio transformation</td><td><code><a href="https://rdrr.io/pkg/SpiecEasi/man/clr.html" class="external-link">clr</a></code></td></tr><tr><td><code>"mclr"</code></td><td>Modified central log ratio transformation</td><td><code><a href="https://rdrr.io/pkg/SPRING/man/mclr.html" class="external-link">mclr</a></code></td></tr></table><p>These methods (except for rarefying) are described in
  <cite>Badri et al.(2020)</cite>.
  <br><br><strong>Transformation methods</strong><br>
  Functions used for transforming associations into dissimilarities:</p><table class="table table"><tr><td>Argument</td><td>Function</td></tr><tr><td><code>"signed"</code></td><td>sqrt(0.5 * (1 - x))</td></tr><tr><td><code>"unsigned"</code></td><td>sqrt(1 - x^2)</td></tr><tr><td><code>"signedPos"</code></td><td>diss &lt;- sqrt(0.5 * (1-x))</td></tr><tr><td></td><td>diss[x &lt; 0] &lt;- 0</td></tr><tr><td><code>"TOMdiss"</code></td><td><code><a href="https://rdrr.io/pkg/WGCNA/man/TOMsimilarity.html" class="external-link">TOMdist</a></code></td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>badri2020normalizationNetCoMi<br><br>
  benjamini2000adaptiveNetCoMi<br><br>
  farcomeni2007someNetCoMi<br><br>
  friedman2012inferringNetCoMi <br><br>
  WGCNApackageNetCoMi<br><br>
  zhang2005generalNetCoMi</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="netAnalyze.html">netAnalyze</a></code> for analyzing the constructed
  network(s), <code><a href="netCompare.html">netCompare</a></code> for network comparison,
  <code><a href="diffnet.html">diffnet</a></code> for constructing differential networks.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load data sets from American Gut Project (from SpiecEasi package)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"amgut1.filt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"amgut2.filt.phy"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single network with the following specifications:</span></span></span>
<span class="r-in"><span><span class="co"># - Association measure: SpiecEasi</span></span></span>
<span class="r-in"><span><span class="co"># - SpiecEasi parameters are defined via 'measurePar' </span></span></span>
<span class="r-in"><span><span class="co">#   (check ?SpiecEasi::spiec.easi for available options)</span></span></span>
<span class="r-in"><span><span class="co"># - Note: 'rep.num' should be higher for real data sets</span></span></span>
<span class="r-in"><span><span class="co"># - Taxa filtering: Keep the 50 taxa with highest variance</span></span></span>
<span class="r-in"><span><span class="co"># - Sample filtering: Keep samples with a total number of reads </span></span></span>
<span class="r-in"><span><span class="co">#   of at least 1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net1</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, </span></span>
<span class="r-in"><span>                     measure <span class="op">=</span> <span class="st">"spieceasi"</span>,</span></span>
<span class="r-in"><span>                     measurePar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"mb"</span>,</span></span>
<span class="r-in"><span>                                       pulsar.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rep.num <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       symBetaMode <span class="op">=</span> <span class="st">"ave"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtTax <span class="op">=</span> <span class="st">"highestVar"</span>,</span></span>
<span class="r-in"><span>                     filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestVar <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                     filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     sparsMethod <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                     normMethod <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 35 samples removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 88 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 261 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'spieceasi' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying data transformations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selecting model with pulsar using stars...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting final estimate with mb...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network analysis (see ?netAnalyze for details)</span></span></span>
<span class="r-in"><span><span class="va">props1</span> <span class="op">&lt;-</span> <span class="fu"><a href="netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net1</span>, clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network plot (see ?plot.microNetProps for details)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Same network as before but on genus level and without taxa filtering</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">amgut.genus.phy</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_glom.html" class="external-link">tax_glom</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, taxrank <span class="op">=</span> <span class="st">"Rank6"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html" class="external-link">otu_table</a></span><span class="op">(</span><span class="va">amgut.genus.phy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  43 296</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Rename taxonomic table and make Rank6 (genus) unique</span></span></span>
<span class="r-in"><span><span class="va">amgut.genus.renamed</span> <span class="op">&lt;-</span> <span class="fu"><a href="renameTaxa.html">renameTaxa</a></span><span class="op">(</span><span class="va">amgut.genus.phy</span>, pat <span class="op">=</span> <span class="st">"&lt;name&gt;"</span>, </span></span>
<span class="r-in"><span>                                  substPat <span class="op">=</span> <span class="st">"&lt;name&gt;_&lt;subst_name&gt;(&lt;subst_R&gt;)"</span>,</span></span>
<span class="r-in"><span>                                  numDupli <span class="op">=</span> <span class="st">"Rank6"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Column 7 contains NAs only and is ignored.</span>
<span class="r-in"><span>                                  </span></span>
<span class="r-in"><span><span class="va">net_genus</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut.genus.renamed</span>, </span></span>
<span class="r-in"><span>                          taxRank <span class="op">=</span> <span class="st">"Rank6"</span>,</span></span>
<span class="r-in"><span>                          measure <span class="op">=</span> <span class="st">"spieceasi"</span>,</span></span>
<span class="r-in"><span>                          measurePar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"mb"</span>,</span></span>
<span class="r-in"><span>                                            pulsar.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rep.num <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            symBetaMode <span class="op">=</span> <span class="st">"ave"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                          filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          sparsMethod <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                          normMethod <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                          verbose <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 35 samples removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 43 taxa and 261 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'spieceasi' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying data transformations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selecting model with pulsar using stars...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting final estimate with mb...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network analysis</span></span></span>
<span class="r-in"><span><span class="va">props_genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net_genus</span>, clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network plot (with some modifications)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props_genus</span>, </span></span>
<span class="r-in"><span>     shortenLabels <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>     labelScale <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>     cexLabels <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Single network with the following specifications:</span></span></span>
<span class="r-in"><span><span class="co"># - Association measure: Pearson correlation</span></span></span>
<span class="r-in"><span><span class="co"># - Taxa filtering: Keep the 50 taxa with highest frequency</span></span></span>
<span class="r-in"><span><span class="co"># - Sample filtering: Keep samples with a total number of reads of at least </span></span></span>
<span class="r-in"><span><span class="co">#  1000 and with at least 10 taxa with a non-zero count</span></span></span>
<span class="r-in"><span><span class="co"># - Zero replacement: A pseudo count of 0.5 is added to all counts</span></span></span>
<span class="r-in"><span><span class="co"># - Normalization: clr transformation</span></span></span>
<span class="r-in"><span><span class="co"># - Sparsification: Threshold = 0.3 </span></span></span>
<span class="r-in"><span><span class="co">#  (an edge exists between taxa with an estimated association &gt;= 0.3)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net2</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, </span></span>
<span class="r-in"><span>                     measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                     filtTax <span class="op">=</span> <span class="st">"highestFreq"</span>,</span></span>
<span class="r-in"><span>                     filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestFreq <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtSamp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numbTaxa"</span>, <span class="st">"totalReads"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">1000</span>, numbTaxa <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     zeroMethod <span class="op">=</span> <span class="st">"pseudo"</span>, </span></span>
<span class="r-in"><span>                     zeroPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pseudocount <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     normMethod <span class="op">=</span> <span class="st">"clr"</span>,</span></span>
<span class="r-in"><span>                     sparsMethod <span class="op">=</span> <span class="st">"threshold"</span>,</span></span>
<span class="r-in"><span>                     thresh <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 35 samples removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 88 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 261 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Pseudo count of 0.5 added.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'threshold' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network analysis</span></span></span>
<span class="r-in"><span><span class="va">props2</span> <span class="op">&lt;-</span> <span class="fu"><a href="netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net2</span>, clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Constructing and analyzing two networks </span></span></span>
<span class="r-in"><span><span class="co"># - A random group variable is used for splitting the data into two groups</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">amgut1.filt</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Option 1: Use the count matrix and group vector as input:</span></span></span>
<span class="r-in"><span><span class="va">net3</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut1.filt</span>,  </span></span>
<span class="r-in"><span>                     group <span class="op">=</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>                     measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                     filtTax <span class="op">=</span> <span class="st">"highestVar"</span>,</span></span>
<span class="r-in"><span>                     filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestVar <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                     filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     zeroMethod <span class="op">=</span> <span class="st">"multRepl"</span>, </span></span>
<span class="r-in"><span>                     normMethod <span class="op">=</span> <span class="st">"clr"</span>,</span></span>
<span class="r-in"><span>                     sparsMethod <span class="op">=</span> <span class="st">"t-test"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute multRepl() ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 't-test' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span><span class="co"># Option 2: Pass the count matrix of group 1 to 'data' </span></span></span>
<span class="r-in"><span><span class="co">#           and that of group 2 to 'data2'</span></span></span>
<span class="r-in"><span><span class="co"># Note: Argument 'jointPrepro' is set to FALSE by default (the data sets </span></span></span>
<span class="r-in"><span><span class="co"># are filtered separately and the intersect of filtered taxa is kept, </span></span></span>
<span class="r-in"><span><span class="co"># which leads to less than 50 taxa in this example).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">amgut1</span> <span class="op">&lt;-</span> <span class="va">amgut1.filt</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">amgut2</span> <span class="op">&lt;-</span> <span class="va">amgut1.filt</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net3</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span>data <span class="op">=</span> <span class="va">amgut1</span>, </span></span>
<span class="r-in"><span>                     data2 <span class="op">=</span> <span class="va">amgut2</span>,</span></span>
<span class="r-in"><span>                     measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                     filtTax <span class="op">=</span> <span class="st">"highestVar"</span>,</span></span>
<span class="r-in"><span>                     filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestVar <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                     filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     zeroMethod <span class="op">=</span> <span class="st">"multRepl"</span>, </span></span>
<span class="r-in"><span>                     normMethod <span class="op">=</span> <span class="st">"clr"</span>,</span></span>
<span class="r-in"><span>                     sparsMethod <span class="op">=</span> <span class="st">"t-test"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 85 taxa removed in each data set.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 42 taxa and 138 samples remaining in group 1.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 42 taxa and 151 samples remaining in group 2.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment in group 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute multRepl() ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment in group 2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute multRepl() ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization in group 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization in group 2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 't-test' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span>                           </span></span>
<span class="r-in"><span><span class="co"># Network analysis</span></span></span>
<span class="r-in"><span><span class="co"># Note: Please zoom into the GCM plot or open a new window using:</span></span></span>
<span class="r-in"><span><span class="co"># x11(width = 10, height = 10)</span></span></span>
<span class="r-in"><span><span class="va">props3</span> <span class="op">&lt;-</span> <span class="fu"><a href="netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net3</span>, clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network plot (same layout is used in both groups)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props3</span>, sameLayout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The two networks can be compared with NetCoMi's function netCompare().</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Example of using the argument "assoBoot"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This functionality is useful for splitting up a large number of bootstrap </span></span></span>
<span class="r-in"><span><span class="co"># replicates and run the bootstrapping procedure iteratively.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">niter</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="co"># Overall number of bootstrap replicates: 5000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a different seed for each iteration</span></span></span>
<span class="r-in"><span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e8</span>, size <span class="op">=</span> <span class="va">niter</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># List where all bootstrap association matrices are stored</span></span></span>
<span class="r-in"><span><span class="va">assoList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">niter</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># assoBoot is set to TRUE to return the bootstrap association matrices</span></span></span>
<span class="r-in"><span>  <span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut1.filt</span>,</span></span>
<span class="r-in"><span>                      filtTax <span class="op">=</span> <span class="st">"highestFreq"</span>,</span></span>
<span class="r-in"><span>                      filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestFreq <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                      filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                      normMethod <span class="op">=</span> <span class="st">"clr"</span>,    </span></span>
<span class="r-in"><span>                      zeroMethod <span class="op">=</span> <span class="st">"pseudoZO"</span>,</span></span>
<span class="r-in"><span>                      sparsMethod <span class="op">=</span> <span class="st">"bootstrap"</span>,</span></span>
<span class="r-in"><span>                      cores <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                      nboot <span class="op">=</span> <span class="va">nboot</span>,</span></span>
<span class="r-in"><span>                      assoBoot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      verbose <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                      seed <span class="op">=</span> <span class="va">seeds</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">assoList</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nboot</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">nboot</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">net</span><span class="op">$</span><span class="va">assoBoot1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘gtools’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:LaplacesDemon’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     ddirichlet, logit, rdirichlet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:permute’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     permute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct the actual network with all 5000 bootstrap association matrices</span></span></span>
<span class="r-in"><span><span class="va">net_final</span> <span class="op">&lt;-</span> <span class="fu">netConstruct</span><span class="op">(</span><span class="va">amgut1.filt</span>,</span></span>
<span class="r-in"><span>                          filtTax <span class="op">=</span> <span class="st">"highestFreq"</span>,</span></span>
<span class="r-in"><span>                          filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestFreq <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          filtSamp <span class="op">=</span> <span class="st">"totalReads"</span>,</span></span>
<span class="r-in"><span>                          filtSampPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalReads <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                          normMethod <span class="op">=</span> <span class="st">"clr"</span>,    </span></span>
<span class="r-in"><span>                          zeroMethod <span class="op">=</span> <span class="st">"pseudoZO"</span>,</span></span>
<span class="r-in"><span>                          sparsMethod <span class="op">=</span> <span class="st">"bootstrap"</span>,</span></span>
<span class="r-in"><span>                          cores <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                          nboot <span class="op">=</span> <span class="va">nboot</span> <span class="op">*</span> <span class="va">niter</span>,</span></span>
<span class="r-in"><span>                          assoBoot <span class="op">=</span> <span class="va">assoList</span>,</span></span>
<span class="r-in"><span>                          verbose <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 77 taxa removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50 taxa and 289 samples remaining.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'bootstrap' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjust for multiple testing via 'adaptBH' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network analysis</span></span></span>
<span class="r-in"><span><span class="va">props</span> <span class="op">&lt;-</span> <span class="fu"><a href="netAnalyze.html">netAnalyze</a></span><span class="op">(</span><span class="va">net_final</span>, clustMethod <span class="op">=</span> <span class="st">"cluster_fast_greedy"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.microNetProps.html">plot</a></span><span class="op">(</span><span class="va">props</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="netConstruct-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://stefpeschel.de/" class="external-link">Stefanie Peschel</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

