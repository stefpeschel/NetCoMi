<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a heatmap with p-values — plotHeat • NetCoMi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a heatmap with p-values — plotHeat"><meta name="description" content="A function to draw heatmaps with the option to use p-values
  or significance codes as cell text. It allows to draw a mixed heatmap with
  different cell text (values, p-values, or significance code) in the lower
  and upper triangle. The function corrplot is used
  for plotting the heatmap."><meta property="og:description" content="A function to draw heatmaps with the option to use p-values
  or significance codes as cell text. It allows to draw a mixed heatmap with
  different cell text (values, p-values, or significance code) in the lower
  and upper triangle. The function corrplot is used
  for plotting the heatmap."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NetCoMi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a heatmap with p-values</h1>

      <div class="d-none name"><code>plotHeat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to draw heatmaps with the option to use p-values
  or significance codes as cell text. It allows to draw a mixed heatmap with
  different cell text (values, p-values, or significance code) in the lower
  and upper triangle. The function <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code> is used
  for plotting the heatmap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotHeat</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  pmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  textUpp <span class="op">=</span> <span class="st">"mat"</span>,</span>
<span>  textLow <span class="op">=</span> <span class="st">"code"</span>,</span>
<span>  methUpp <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  methLow <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  labPos <span class="op">=</span> <span class="st">"lt"</span>,</span>
<span>  labCol <span class="op">=</span> <span class="st">"gray40"</span>,</span>
<span>  labCex <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  textCol <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  textCex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  textFont <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  legendPos <span class="op">=</span> <span class="st">"r"</span>,</span>
<span>  colorPal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  addWhite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nCol <span class="op">=</span> <span class="fl">51L</span>,</span>
<span>  colorLim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  revCol <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  argsUpp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  argsLow <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mat">mat<a class="anchor" aria-label="anchor" href="#arg-mat"></a></dt>
<dd><p>numeric matrix with values to be plotted.</p></dd>


<dt id="arg-pmat">pmat<a class="anchor" aria-label="anchor" href="#arg-pmat"></a></dt>
<dd><p>optional matrix with p-values.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character defining the type of the heatmap. Possible values are:</p><dl><dt><code>"full"</code></dt>
<dd><p>Default. The cell text specified via <code>textUpp</code> is
used for the whole heatmap.</p></dd>

<dt><code>"mixed"</code></dt>
<dd><p>Different cell text is used for the upper and lower
triangle. The upper triangle is specified via <code>textUpp</code> and the lower
triangle via <code>textLow</code>.</p></dd>

<dt><code>"upper"</code></dt>
<dd><p>Only the upper triangle is plotted. The text is
specified via <code>textUpp</code>.</p></dd>

<dt><code>"lower"</code></dt>
<dd><p>Only the lower triangle is plotted. The text is
specified via <code>textLow</code>.</p></dd>


</dl></dd>


<dt id="arg-textupp">textUpp<a class="anchor" aria-label="anchor" href="#arg-textupp"></a></dt>
<dd><p>character specifying the cell text either for the
full heatmap (if <code>type</code> is "full") or for the upper triangle (if
<code>type</code> is "mixed" or "upper"). Default is "mat". Possible values are:</p><dl><dt><code>"mat"</code></dt>
<dd><p>Cells contain the values in the matrix given by
<code>mat</code></p></dd>

<dt><code>"sigmat"</code></dt>
<dd><p>Same as "mat" but insignificant values (and cells)
are blank.</p></dd>

<dt><code>"pmat"</code></dt>
<dd><p>Cells contain the p-values given by <code>p-mat</code>.</p></dd>

<dt><code>"code"</code></dt>
<dd><p>Cells contain significance codes corresponding to the
p-values given by <code>p-mat</code>. The following coding is used:
"***: 0.001;  **: 0.01;  *: 0.05".</p></dd>

<dt><code>"none"</code></dt>
<dd><p>No cell text is plotted.</p></dd>


</dl></dd>


<dt id="arg-textlow">textLow<a class="anchor" aria-label="anchor" href="#arg-textlow"></a></dt>
<dd><p>same as <code>textUpp</code> but for the lower triangle
(if <code>type</code> is "mixed" or "lower"). Default is "code".</p></dd>


<dt id="arg-methupp">methUpp<a class="anchor" aria-label="anchor" href="#arg-methupp"></a></dt>
<dd><p>character specifying how values are represented in the
full heatmap (if <code>type</code> is "full") or in the upper triangle (if
<code>type</code> is "mixed" or "upper").
Possible values are: "circle", "square", "ellipse", "number",
"shade", "color" (default), "pie". The method is passed to the
<code>method</code> argument of <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code>.</p></dd>


<dt id="arg-methlow">methLow<a class="anchor" aria-label="anchor" href="#arg-methlow"></a></dt>
<dd><p>same es <code>methUpp</code> but for the lower triangle.</p></dd>


<dt id="arg-diag">diag<a class="anchor" aria-label="anchor" href="#arg-diag"></a></dt>
<dd><p>logical. If <code>TRUE</code> (default), the diagonal is printed.
If <code>FALSE</code> and <code>type</code> is "full" or "mixed", the diagonal cells
are white. If <code>FALSE</code> and <code>type</code> is "upper" or "lower", only the
non-diagonal cells are printed.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>character giving the title.</p></dd>


<dt id="arg-mar">mar<a class="anchor" aria-label="anchor" href="#arg-mar"></a></dt>
<dd><p>vector specifying the plot margins.
See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>. Default is c(0, 0, 1, 0).</p></dd>


<dt id="arg-labpos">labPos<a class="anchor" aria-label="anchor" href="#arg-labpos"></a></dt>
<dd><p>character defining the label position. Possible values are:
"lt"(left and top, default),
"ld"(left and diagonal; <code>type</code> must be "lower"),
"td"(top and diagonal; <code>type</code> must be "upper"),
"d"(diagonal only), "n"(no labels). Passed to
<code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code> argument <code>tl.pos</code>.</p></dd>


<dt id="arg-labcol">labCol<a class="anchor" aria-label="anchor" href="#arg-labcol"></a></dt>
<dd><p>label color. Default is "gray40". Passed to
<code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code> argument <code>tl.col</code>.</p></dd>


<dt id="arg-labcex">labCex<a class="anchor" aria-label="anchor" href="#arg-labcex"></a></dt>
<dd><p>numeric defining the label size. Default is 1.1. Passed to
<code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code> argument <code>tl.cex</code>.</p></dd>


<dt id="arg-textcol">textCol<a class="anchor" aria-label="anchor" href="#arg-textcol"></a></dt>
<dd><p>color of the cell text (values, p-values, and code). Default
is "black".</p></dd>


<dt id="arg-textcex">textCex<a class="anchor" aria-label="anchor" href="#arg-textcex"></a></dt>
<dd><p>numeric defining the text size. Default is 1. Currently only
works for types "mat" and "code".</p></dd>


<dt id="arg-textfont">textFont<a class="anchor" aria-label="anchor" href="#arg-textfont"></a></dt>
<dd><p>numeric defining the text font. Default is 1. Currently only
works for type "mat".</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>integer defining the number of decimal places used for
matrix values and p-values.</p></dd>


<dt id="arg-legendpos">legendPos<a class="anchor" aria-label="anchor" href="#arg-legendpos"></a></dt>
<dd><p>position of the color legend. Possible values are:
"r"(right; default), "b"(bottom), "n"(no legend).</p></dd>


<dt id="arg-colorpal">colorPal<a class="anchor" aria-label="anchor" href="#arg-colorpal"></a></dt>
<dd><p>character specifying the color palette used for cell coloring
if <code>color</code> is not set. Available are the sequential and diverging
color palettes from <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer</a></code>:</p><dl><dt>Sequential:</dt>
<dd><p>"Blues", "BuGn", "BuPu", "GnBu", "Greens", "Greys",
"Oranges", "OrRd", "PuBu", "PuBuGn", "PuRd", "Purples", "RdPu", "Reds",
"YlGn", "YlGnBu", "YlOrBr", "YlOrRd"</p></dd>

<dt>Diverging:</dt>
<dd><p>"BrBG", "PiYG", "PRGn", "PuOr", "RdBu", "RdGy", "RdYlBu",
"RdYlGn", "Spectral"</p></dd>


</dl><p>By default, "RdBu" is used if the first value of <code>colorLim</code> is
negative and "YlOrRd" otherwise.</p></dd>


<dt id="arg-addwhite">addWhite<a class="anchor" aria-label="anchor" href="#arg-addwhite"></a></dt>
<dd><p>logical. If <code>TRUE</code>, white is added to the color palette.
(first element for sequential palettes and middle element for diverging
palettes). For a diverging palette, <code>nCol</code> should be set to an odd
number so that the middle color is white.</p></dd>


<dt id="arg-ncol">nCol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>integer defining the number of colors to which the color palette
should be interpolated. Default is 51L.
<code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRamp</a></code> is used for color interpolation.</p></dd>


<dt id="arg-colorlim">colorLim<a class="anchor" aria-label="anchor" href="#arg-colorlim"></a></dt>
<dd><p>numeric vector with two values defining the color limits.
The first element of the color vector is assigned to the lower limit and
the last element of the color vector to the upper limit. Default is
c(0,1) if the values of <code>mat</code> are in [0,1], c(-1,1) if the values are
in [-1,1], and the minimum and maximum values otherwise.</p></dd>


<dt id="arg-revcol">revCol<a class="anchor" aria-label="anchor" href="#arg-revcol"></a></dt>
<dd><p>logical. If <code>TRUE</code>, the reversed color vector is used.
Default is <code>FALSE</code>. Ignored if <code>color</code> is given.</p></dd>


<dt id="arg-color">color<a class="anchor" aria-label="anchor" href="#arg-color"></a></dt>
<dd><p>an optional vector with colors used for cell coloring.</p></dd>


<dt id="arg-bg">bg<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>background color of the cells. Default is "white".</p></dd>


<dt id="arg-argsupp">argsUpp<a class="anchor" aria-label="anchor" href="#arg-argsupp"></a></dt>
<dd><p>optional list of arguments passed to
<code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code>. Arguments set within <code>plotHeat()</code>
are overwritten by arguments in the list. Used for the
full heatmap if <code>type</code> is "full" and for the upper triangle if
<code>type</code> is "mixed" or "upper".</p></dd>


<dt id="arg-argslow">argsLow<a class="anchor" aria-label="anchor" href="#arg-argslow"></a></dt>
<dd><p>same as <code>argsUpp</code> but for the lower triangle
(if <code>type</code> is "mixed" or "lower").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisible list with two elements <code>argsUpper</code> and
  <code>argsLower</code> containing the <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></code>
  arguments used for the upper and lower triangle of the heatmap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load data sets from American Gut Project (from SpiecEasi package)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"amgut2.filt.phy"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split data into two groups: with and without seasonal allergies</span></span></span>
<span class="r-in"><span><span class="va">amgut_season_yes</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, </span></span>
<span class="r-in"><span>                                      <span class="va">SEASONAL_ALLERGIES</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">amgut_season_no</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">amgut2.filt.phy</span>, </span></span>
<span class="r-in"><span>                                     <span class="va">SEASONAL_ALLERGIES</span> <span class="op">==</span> <span class="st">"no"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample sizes</span></span></span>
<span class="r-in"><span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/nsamples-methods.html" class="external-link">nsamples</a></span><span class="op">(</span><span class="va">amgut_season_yes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 121</span>
<span class="r-in"><span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/nsamples-methods.html" class="external-link">nsamples</a></span><span class="op">(</span><span class="va">amgut_season_no</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 163</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sample sizes equal to ensure comparability</span></span></span>
<span class="r-in"><span><span class="va">n_yes</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/nsamples-methods.html" class="external-link">nsamples</a></span><span class="op">(</span><span class="va">amgut_season_yes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">amgut_season_no</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">amgut_season_no</span>, <span class="va">X.SampleID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span></span>
<span class="r-in"><span>                                     <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html" class="external-link">get_variable</a></span><span class="op">(</span><span class="va">amgut_season_no</span>, </span></span>
<span class="r-in"><span>                                     <span class="st">"X.SampleID"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_yes</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'table' in selecting a method for function '%in%': error in evaluating the argument 'object' in selecting a method for function 'sample_data': object 'amgut_season_no' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Network construction</span></span></span>
<span class="r-in"><span><span class="va">amgut_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="netConstruct.html">netConstruct</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">amgut_season_yes</span>,</span></span>
<span class="r-in"><span>                          data2 <span class="op">=</span> <span class="va">amgut_season_no</span>,</span></span>
<span class="r-in"><span>                          measure <span class="op">=</span> <span class="st">"pearson"</span>,</span></span>
<span class="r-in"><span>                          filtTax <span class="op">=</span> <span class="st">"highestVar"</span>,</span></span>
<span class="r-in"><span>                          filtTaxPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>highestVar <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          zeroMethod <span class="op">=</span> <span class="st">"pseudoZO"</span>, </span></span>
<span class="r-in"><span>                          normMethod <span class="op">=</span> <span class="st">"clr"</span>,</span></span>
<span class="r-in"><span>                          sparsMethod <span class="op">=</span> <span class="st">"thresh"</span>,</span></span>
<span class="r-in"><span>                          thresh <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>                          seed <span class="op">=</span> <span class="fl">123456</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input arguments ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data filtering ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 95 taxa removed in each data set.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 rows with zero sum removed in group 1.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 rows with zero sum removed in group 2.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 43 taxa and 120 samples remaining in group 1.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 43 taxa and 162 samples remaining in group 2.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment in group 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero treatment in group 2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Zero counts replaced by 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization in group 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Normalization in group 2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Execute clr(){SpiecEasi} ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate 'pearson' associations ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations via 'threshold' ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sparsify associations in group 2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimated and sparsified associations of group 1</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span><span class="va">amgut_net</span><span class="op">$</span><span class="va">assoEst1</span>, textUpp <span class="op">=</span> <span class="st">"none"</span>, labCex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span><span class="va">amgut_net</span><span class="op">$</span><span class="va">assoMat1</span>, textUpp <span class="op">=</span> <span class="st">"none"</span>, labCex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute graphlet correlation matrices and perform significance tests</span></span></span>
<span class="r-in"><span><span class="va">adja1</span> <span class="op">&lt;-</span> <span class="va">amgut_net</span><span class="op">$</span><span class="va">adjaMat1</span></span></span>
<span class="r-in"><span><span class="va">adja2</span> <span class="op">&lt;-</span> <span class="va">amgut_net</span><span class="op">$</span><span class="va">adjaMat2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gcm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcGCM.html">calcGCM</a></span><span class="op">(</span><span class="va">adja1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcGCM.html">calcGCM</a></span><span class="op">(</span><span class="va">adja2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gcmtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="testGCM.html">testGCM</a></span><span class="op">(</span>obj1 <span class="op">=</span> <span class="va">gcm1</span>, obj2 <span class="op">=</span> <span class="va">gcm2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Perform Student's t-test for GCM1 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Adjust for multiple testing ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.22</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Perform Student's t-test for GCM2 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Adjust for multiple testing ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.08</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Test GCM1 and GCM2 for differences ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Adjust for multiple testing ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Proportion of true null hypotheses: 0.64</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed heatmap of GCM1 and significance codes</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">gcm1</span>, </span></span>
<span class="r-in"><span>         pmat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">pAdjust1</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"mixed"</span>, </span></span>
<span class="r-in"><span>         textLow <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed heatmap of GCM2 and p-values (diagonal disabled)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">gcm1</span>, </span></span>
<span class="r-in"><span>         pmat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">pAdjust1</span>,</span></span>
<span class="r-in"><span>         diag <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"mixed"</span>, </span></span>
<span class="r-in"><span>         textLow <span class="op">=</span> <span class="st">"pmat"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed heatmap of differences (GCM1 - GCM2) and significance codes</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span>, </span></span>
<span class="r-in"><span>         pmat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">pAdjustDiff</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"mixed"</span>, </span></span>
<span class="r-in"><span>         textLow <span class="op">=</span> <span class="st">"code"</span>,</span></span>
<span class="r-in"><span>         title <span class="op">=</span> <span class="st">"Differences between GCMs (GCM1 - GCM2)"</span>,</span></span>
<span class="r-in"><span>         mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Heatmap of differences (insignificant values are blank)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span>, </span></span>
<span class="r-in"><span>         pmat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">pAdjustDiff</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>         textUpp <span class="op">=</span> <span class="st">"sigmat"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as before but with higher significance level</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span>, </span></span>
<span class="r-in"><span>         pmat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">pAdjustDiff</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>         textUpp <span class="op">=</span> <span class="st">"sigmat"</span>,</span></span>
<span class="r-in"><span>         argsUpp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sig.level <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Heatmap of absolute differences</span></span></span>
<span class="r-in"><span><span class="co"># (different position of labels and legend)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">absDiff</span>, </span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>         labPos <span class="op">=</span> <span class="st">"d"</span>,</span></span>
<span class="r-in"><span>         legendPos <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed heatmap of absolute differences </span></span></span>
<span class="r-in"><span><span class="co"># (different methods, text options, and color palette)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">absDiff</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"mixed"</span>,</span></span>
<span class="r-in"><span>         textLow <span class="op">=</span> <span class="st">"mat"</span>,</span></span>
<span class="r-in"><span>         methUpp <span class="op">=</span> <span class="st">"number"</span>,</span></span>
<span class="r-in"><span>         methLow <span class="op">=</span> <span class="st">"circle"</span>,</span></span>
<span class="r-in"><span>         labCol <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>         textCol <span class="op">=</span> <span class="st">"gray50"</span>,</span></span>
<span class="r-in"><span>         textCex <span class="op">=</span> <span class="fl">1.3</span>,</span></span>
<span class="r-in"><span>         textFont <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         digits <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>         colorLim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">gcmtest</span><span class="op">$</span><span class="va">absDiff</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         colorPal <span class="op">=</span> <span class="st">"Blues"</span>,</span></span>
<span class="r-in"><span>         nCol <span class="op">=</span> <span class="fl">21L</span>,</span></span>
<span class="r-in"><span>         bg <span class="op">=</span> <span class="st">"darkorange"</span>,</span></span>
<span class="r-in"><span>         addWhite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed heatmap of differences </span></span></span>
<span class="r-in"><span><span class="co"># (different methods, text options, and color palette)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span>,</span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"mixed"</span>,</span></span>
<span class="r-in"><span>         textLow <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>         methUpp <span class="op">=</span> <span class="st">"number"</span>,</span></span>
<span class="r-in"><span>         methLow <span class="op">=</span> <span class="st">"pie"</span>,</span></span>
<span class="r-in"><span>         textCex <span class="op">=</span> <span class="fl">1.3</span>,</span></span>
<span class="r-in"><span>         textFont <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         digits <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>         colorLim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         colorPal <span class="op">=</span> <span class="st">"PiYG"</span>,</span></span>
<span class="r-in"><span>         nCol <span class="op">=</span> <span class="fl">21L</span>,</span></span>
<span class="r-in"><span>         bg <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Heatmap of differences with given color vector</span></span></span>
<span class="r-in"><span><span class="fu">plotHeat</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">gcmtest</span><span class="op">$</span><span class="va">diff</span>, </span></span>
<span class="r-in"><span>         nCol <span class="op">=</span> <span class="fl">21L</span>,</span></span>
<span class="r-in"><span>         color <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">31</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotHeat-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefanie Peschel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

